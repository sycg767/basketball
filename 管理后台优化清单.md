# 篮球场馆管理后台优化清单

## 📊 功能分析总结

### ✅ 已完整实现的功能（8个模块）

1. **Dashboard 数据统计** ✅
   - 统计卡片：场地总数(9)、用户总数(12)、预订总数(64)、总收入(¥8213.71)
   - 预订趋势图表（7/15/30天可选）
   - 场地使用率饼图
   - 最近预订列表
   - **状态**：后端API已实现，测试通过，数据正常展示

2. **场地管理** ✅
   - CRUD操作、价格配置、状态管理

3. **预订管理** ✅
   - 列表查询、详情查看、取消预订

4. **课程管理** ✅
   - 课程CRUD、排期管理、教练分配

5. **用户管理** ✅
   - 用户列表、编辑、启用/禁用

6. **会员管理** ✅
   - 会员卡类型管理、会员卡管理、激活/冻结

7. **财务管理** ✅
   - 财务记录CRUD、统计数据、收支管理

8. **公告管理** ✅
   - 公告CRUD、发布/下架

---

## ❌ 需要实现的功能模块

### 高优先级 🔴

#### 1. 会员活跃度分析 ❌
**问题**：前端页面完整，但后端API完全未实现

**缺失的API**：
- `GET /api/admin/analytics/member/activity-trend` - 会员活跃度趋势
- `GET /api/admin/analytics/member/active-users` - 活跃用户列表
- `GET /api/admin/analytics/member/inactive-users` - 不活跃用户列表
- `GET /api/admin/analytics/member/churn-risk` - 流失风险用户列表
- `GET /api/admin/analytics/member/detail` - 用户活跃度详情
- `POST /api/admin/analytics/member/analyze` - 手动触发分析

**需要创建的文件**：
- `MemberAnalyticsController.java`
- `IMemberAnalyticsService.java`
- `MemberAnalyticsServiceImpl.java`
- `MemberActivityAnalysis.java` (实体类)
- `MemberActivityAnalysisMapper.java`

**预计工作量**：2-3小时

---

#### 2. 课程热度分析 ❌
**问题**：前端页面完整，但后端API完全未实现

**缺失的API**：
- `GET /api/admin/analytics/course/popularity-ranking` - 课程热度排行榜
- `GET /api/admin/analytics/course/popularity-trend` - 课程热度趋势
- `GET /api/admin/analytics/course/hot-courses` - 热门课程列表
- `GET /api/admin/analytics/course/cold-courses` - 冷门课程列表
- `GET /api/admin/analytics/course/conversion-analysis` - 课程转化率分析
- `GET /api/admin/analytics/course/popularity-detail` - 课程热度详情
- `POST /api/admin/analytics/course/analyze` - 手动触发分析

**需要创建的文件**：
- `CourseAnalyticsController.java`
- `ICourseAnalyticsService.java`
- `CourseAnalyticsServiceImpl.java`
- `CoursePopularityAnalysis.java` (实体类)
- `CoursePopularityAnalysisMapper.java`

**预计工作量**：2-3小时

---

#### 3. 场地使用分析 ❌
**问题**：前端页面完整，但后端API完全未实现

**缺失的API**：
- `GET /api/admin/analytics/venue/usage-ranking` - 场地使用率排行榜
- `GET /api/admin/analytics/venue/usage-trend` - 场地使用趋势
- `GET /api/admin/analytics/venue/high-usage` - 高使用率场地列表
- `GET /api/admin/analytics/venue/low-usage` - 低使用率场地列表
- `GET /api/admin/analytics/venue/revenue-analysis` - 场地收入分析
- `GET /api/admin/analytics/venue/peak-period` - 高峰时段分析
- `GET /api/admin/analytics/venue/usage-detail` - 场地使用详情
- `POST /api/admin/analytics/venue/analyze` - 手动触发分析

**需要创建的文件**：
- `VenueAnalyticsController.java`
- `IVenueAnalyticsService.java`
- `VenueAnalyticsServiceImpl.java`
- `VenueUsageAnalysis.java` (实体类)
- `VenueUsageAnalysisMapper.java`

**预计工作量**：2-3小时

---

### 中优先级 🟡

#### 4. 日志管理 ❓
**状态**：前端页面存在，后端实现情况未知
**文件位置**：`basketball-web/src/views/admin/logs/LogManage.vue`
**预计工作量**：1-2小时

#### 5. 系统设置 ❓
**状态**：前端页面存在，后端实现情况未知
**文件位置**：`basketball-web/src/views/admin/settings/SettingsManage.vue`
**预计工作量**：1-2小时

### 低优先级 🟢

#### 6. 数据字典管理 ❓
**状态**：前端页面存在，后端实现情况未知
**文件位置**：`basketball-web/src/views/admin/settings/DictionaryManage.vue`
**预计工作量**：1小时

---

## 🎯 实施计划

### 第一阶段：数据分析功能（核心）
1. ✅ 会员活跃度分析
2. ✅ 课程热度分析
3. ✅ 场地使用分析

### 第二阶段：辅助功能
4. ✅ 日志管理
5. ✅ 系统设置
6. ✅ 数据字典管理

---

## 📝 实施进度

- [x] 1. 会员活跃度分析 - ✅ **已完成**（后端API已实现）
- [x] 2. 课程热度分析 - ✅ **已完成**（后端API已实现）
- [x] 3. 场地使用分析 - ✅ **已完成**（后端API已实现）
- [ ] 4. 日志管理 - ⚠️ 待验证
- [ ] 5. 系统设置 - ⚠️ 待验证
- [ ] 6. 数据字典管理 - ⚠️ 待验证

---

## 💡 技术实现要点

### 数据分析模块通用设计

#### 1. 数据库表设计
```sql
-- 会员活跃度分析表
CREATE TABLE member_activity_analysis (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL COMMENT '用户ID',
    analysis_date DATE NOT NULL COMMENT '分析日期',
    login_count INT DEFAULT 0 COMMENT '登录次数',
    booking_count INT DEFAULT 0 COMMENT '预订次数',
    course_count INT DEFAULT 0 COMMENT '课程次数',
    activity_score INT DEFAULT 0 COMMENT '活跃度分数',
    last_active_time DATETIME COMMENT '最后活跃时间',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_user_date (user_id, analysis_date),
    INDEX idx_date (analysis_date)
);

-- 课程热度分析表
CREATE TABLE course_popularity_analysis (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    course_id BIGINT NOT NULL COMMENT '课程ID',
    analysis_date DATE NOT NULL COMMENT '分析日期',
    view_count INT DEFAULT 0 COMMENT '浏览次数',
    enrollment_count INT DEFAULT 0 COMMENT '报名次数',
    completion_count INT DEFAULT 0 COMMENT '完成次数',
    popularity_score INT DEFAULT 0 COMMENT '热度分数',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_course_date (course_id, analysis_date),
    INDEX idx_date (analysis_date)
);

-- 场地使用分析表
CREATE TABLE venue_usage_analysis (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    venue_id BIGINT NOT NULL COMMENT '场地ID',
    analysis_date DATE NOT NULL COMMENT '分析日期',
    booking_count INT DEFAULT 0 COMMENT '预订次数',
    usage_hours DECIMAL(10,2) DEFAULT 0 COMMENT '使用时长',
    revenue DECIMAL(10,2) DEFAULT 0 COMMENT '收入',
    usage_rate DECIMAL(5,2) DEFAULT 0 COMMENT '使用率',
    peak_period VARCHAR(50) COMMENT '高峰时段',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_venue_date (venue_id, analysis_date),
    INDEX idx_date (analysis_date)
);
```

#### 2. 活跃度计算规则
- 登录次数权重：20%
- 预订次数权重：40%
- 课程参与权重：40%
- 总分：100分

#### 3. 流失风险判定
- 高风险：30天未活跃
- 中风险：15-30天未活跃
- 低风险：7-15天未活跃

---

## 🚀 开始实施

**当前任务**：从第1项"会员活跃度分析"开始实现

**下一步操作**：
1. 创建数据库表
2. 创建实体类和Mapper
3. 实现Service业务逻辑
4. 实现Controller接口
5. 测试API接口
6. 验证前端数据展示

---

**创建时间**：2025-01-22
**最后更新**：2025-01-22
