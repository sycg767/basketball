import{_ as U,r as f,k as F,t as L,d as g,e as o,b as t,a as n,f as p,v as l,c as m,g as j,F as q,N as A,E as b,m as G,o as c,u as r,J as I,G as J,ai as O,aj as $,U as H,i as k,O as C,ae as K,ak as Q}from"./index-DqRIPXSt.js";import{g as W,f as X}from"./member-Ch_HX4wW.js";import{B as Y}from"./BackButton-CB8aFD-N.js";const Z={class:"points-container"},tt={class:"points-showcase"},st={class:"points-card-main"},et={class:"points-content"},ot={class:"points-header"},at={class:"points-icon"},it={class:"points-main"},nt={class:"points-value"},lt={class:"points-tips-card"},ct={class:"tips-list"},dt={class:"tip-item"},rt={class:"tip-icon"},pt={class:"tip-item"},ut={class:"tip-icon"},_t={class:"tip-item"},vt={class:"tip-icon"},ft={class:"records-section"},gt={class:"section-header"},mt={key:0,class:"records-list"},ht={class:"record-info"},yt={class:"record-main"},xt={class:"record-type"},bt={class:"record-desc"},kt={class:"record-meta"},Ct={class:"record-time"},zt={class:"record-amount"},Pt={class:"amount-balance"},wt={__name:"Points",setup(Bt){G();const z=f(0),_=f(0),h=f([]),y=f(0),d=F({page:1,pageSize:10}),P=async()=>{try{const a=await W();a.code===200&&(z.value=a.data)}catch{b.error("获取积分失败")}},u=async()=>{try{const a=await X(d);if(a.code===200){let s=a.data.records;_.value===1?s=s.filter(i=>i.points>0):_.value===2&&(s=s.filter(i=>i.points<0)),h.value=s,y.value=s.length}}catch{b.error("获取积分记录失败")}},B=()=>{P(),u(),b.success("刷新成功")},S=()=>{d.page=1,u()},D=()=>{d.page=1,u()},M=()=>{u()},V=a=>({1:"消费赠送",2:"积分兑换",3:"积分过期",4:"手动调整"})[a]||"未知",N=a=>{if(!a)return"";const s=new Date,i=new Date(a),v=Math.floor((i-s)/(1e3*60*60*24));return v<0?"text-expired":v<30?"text-warning":""},w=a=>a||"-";return L(()=>{P(),u()}),(a,s)=>{const i=p("el-icon"),v=p("el-button"),x=p("el-radio-button"),T=p("el-radio-group"),E=p("el-empty"),R=p("el-pagination");return c(),g("div",Z,[o(Y,{text:"返回"}),t("div",tt,[t("div",st,[s[5]||(s[5]=t("div",{class:"points-background"},[t("div",{class:"bg-circle circle-1"}),t("div",{class:"bg-circle circle-2"}),t("div",{class:"bg-circle circle-3"})],-1)),t("div",et,[t("div",ot,[t("div",at,[o(i,null,{default:n(()=>[o(r(I))]),_:1})]),o(v,{type:"primary",onClick:B,class:"refresh-btn"},{default:n(()=>[o(i,null,{default:n(()=>[o(r(J))]),_:1})]),_:1})]),t("div",it,[s[3]||(s[3]=t("div",{class:"points-label"},"我的积分",-1)),t("div",nt,l(z.value.toLocaleString()),1),s[4]||(s[4]=t("div",{class:"points-subtitle"},"Points Balance",-1))])])]),t("div",lt,[s[9]||(s[9]=t("h3",{class:"tips-title"},"积分规则",-1)),t("div",ct,[t("div",dt,[t("div",rt,[o(i,null,{default:n(()=>[o(r(O))]),_:1})]),s[6]||(s[6]=t("div",{class:"tip-content"},[t("div",{class:"tip-title"},"消费赚积分"),t("div",{class:"tip-desc"},"每消费1元获得1积分")],-1))]),t("div",pt,[t("div",ut,[o(i,null,{default:n(()=>[o(r($))]),_:1})]),s[7]||(s[7]=t("div",{class:"tip-content"},[t("div",{class:"tip-title"},"积分可兑换"),t("div",{class:"tip-desc"},"兑换礼品或抵扣消费")],-1))]),t("div",_t,[t("div",vt,[o(i,null,{default:n(()=>[o(r(H))]),_:1})]),s[8]||(s[8]=t("div",{class:"tip-content"},[t("div",{class:"tip-title"},"有效期1年"),t("div",{class:"tip-desc"},"请及时使用积分")],-1))])])])]),t("div",ft,[t("div",gt,[s[13]||(s[13]=t("h2",{class:"section-title"},"积分明细",-1)),o(T,{modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=e=>_.value=e),size:"default",onChange:S,class:"filter-tabs"},{default:n(()=>[o(x,{label:0},{default:n(()=>[...s[10]||(s[10]=[k("全部",-1)])]),_:1}),o(x,{label:1},{default:n(()=>[...s[11]||(s[11]=[k("获得",-1)])]),_:1}),o(x,{label:2},{default:n(()=>[...s[12]||(s[12]=[k("消费",-1)])]),_:1})]),_:1},8,["modelValue"])]),h.value.length>0?(c(),g("div",mt,[(c(!0),g(q,null,A(h.value,e=>(c(),g("div",{key:e.id,class:"record-item"},[t("div",{class:C(["record-icon",e.points>0?"icon-gain":"icon-cost"])},[e.points>0?(c(),m(i,{key:0},{default:n(()=>[o(r(K))]),_:1})):(c(),m(i,{key:1},{default:n(()=>[o(r(Q))]),_:1}))],2),t("div",ht,[t("div",yt,[t("span",xt,l(V(e.type)),1),t("span",bt,l(e.remark),1)]),t("div",kt,[t("span",Ct,l(w(e.createTime)),1),t("span",{class:C(["record-expire",N(e.expireDate)])},l(e.expireDate?`有效期至 ${w(e.expireDate)}`:""),3)])]),t("div",zt,[t("div",{class:C(["amount-change",e.points>0?"text-success":"text-danger"])},l(e.points>0?"+":"")+l(e.points),3),t("div",Pt,"余额 "+l(e.pointsAfter),1)])]))),128))])):(c(),m(E,{key:1,description:"暂无积分记录",class:"empty-records"})),y.value>0?(c(),m(R,{key:2,class:"pagination","current-page":d.page,"onUpdate:currentPage":s[1]||(s[1]=e=>d.page=e),"page-size":d.pageSize,"onUpdate:pageSize":s[2]||(s[2]=e=>d.pageSize=e),total:y.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:D,onCurrentChange:M},null,8,["current-page","page-size","total"])):j("",!0)])])}}},Vt=U(wt,[["__scopeId","data-v-280175cd"]]);export{Vt as default};
