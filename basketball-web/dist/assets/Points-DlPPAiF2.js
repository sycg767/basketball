import{_ as j,r as f,k as q,t as A,d as g,e as o,b as t,f as p,a as n,B as l,c as m,g as I,F as Q,x as $,E as x,m as G,o as c,u,Q as H,N as J,ag as K,ah as O,T as W,i as k,z,ab as X,ai as Y}from"./index-DU9PCbH8.js";import{g as Z,e as tt}from"./member-D45oi1Qc.js";const st={class:"points-container"},et={class:"points-showcase"},ot={class:"points-card-main"},at={class:"points-content"},nt={class:"points-header"},it={class:"points-icon"},lt={class:"points-main"},ct={class:"points-value"},dt={class:"points-tips-card"},rt={class:"tips-list"},pt={class:"tip-item"},ut={class:"tip-icon"},_t={class:"tip-item"},vt={class:"tip-icon"},ft={class:"tip-item"},gt={class:"tip-icon"},mt={class:"records-section"},ht={class:"section-header"},yt={key:0,class:"records-list"},bt={class:"record-info"},xt={class:"record-main"},kt={class:"record-type"},zt={class:"record-desc"},Ct={class:"record-meta"},Pt={class:"record-time"},wt={class:"record-amount"},Bt={class:"amount-balance"},St={__name:"Points",setup(Dt){const B=G(),S=()=>{B.back()},C=f(0),v=f(0),h=f([]),y=f(0),d=q({page:1,pageSize:10}),P=async()=>{try{const a=await Z();a.code===200&&(C.value=a.data)}catch{x.error("获取积分失败")}},_=async()=>{try{const a=await tt(d);if(a.code===200){let s=a.data.records;v.value===1?s=s.filter(r=>r.points>0):v.value===2&&(s=s.filter(r=>r.points<0)),h.value=s,y.value=s.length}}catch{x.error("获取积分记录失败")}},D=()=>{P(),_(),x.success("刷新成功")},M=()=>{d.page=1,_()},V=()=>{d.page=1,_()},T=()=>{_()},N=a=>({1:"消费赠送",2:"积分兑换",3:"积分过期",4:"手动调整"})[a]||"未知",E=a=>{if(!a)return"";const s=new Date,r=new Date(a),i=Math.floor((r-s)/(1e3*60*60*24));return i<0?"text-expired":i<30?"text-warning":""},w=a=>a||"-";return A(()=>{P(),_()}),(a,s)=>{const r=p("el-page-header"),i=p("el-icon"),R=p("el-button"),b=p("el-radio-button"),F=p("el-radio-group"),L=p("el-empty"),U=p("el-pagination");return c(),g("div",st,[o(r,{onBack:S,content:"我的积分"}),t("div",et,[t("div",ot,[s[5]||(s[5]=t("div",{class:"points-background"},[t("div",{class:"bg-circle circle-1"}),t("div",{class:"bg-circle circle-2"}),t("div",{class:"bg-circle circle-3"})],-1)),t("div",at,[t("div",nt,[t("div",it,[o(i,null,{default:n(()=>[o(u(H))]),_:1})]),o(R,{type:"primary",onClick:D,class:"refresh-btn"},{default:n(()=>[o(i,null,{default:n(()=>[o(u(J))]),_:1})]),_:1})]),t("div",lt,[s[3]||(s[3]=t("div",{class:"points-label"},"我的积分",-1)),t("div",ct,l(C.value.toLocaleString()),1),s[4]||(s[4]=t("div",{class:"points-subtitle"},"Points Balance",-1))])])]),t("div",dt,[s[9]||(s[9]=t("h3",{class:"tips-title"},"积分规则",-1)),t("div",rt,[t("div",pt,[t("div",ut,[o(i,null,{default:n(()=>[o(u(K))]),_:1})]),s[6]||(s[6]=t("div",{class:"tip-content"},[t("div",{class:"tip-title"},"消费赚积分"),t("div",{class:"tip-desc"},"每消费1元获得1积分")],-1))]),t("div",_t,[t("div",vt,[o(i,null,{default:n(()=>[o(u(O))]),_:1})]),s[7]||(s[7]=t("div",{class:"tip-content"},[t("div",{class:"tip-title"},"积分可兑换"),t("div",{class:"tip-desc"},"兑换礼品或抵扣消费")],-1))]),t("div",ft,[t("div",gt,[o(i,null,{default:n(()=>[o(u(W))]),_:1})]),s[8]||(s[8]=t("div",{class:"tip-content"},[t("div",{class:"tip-title"},"有效期1年"),t("div",{class:"tip-desc"},"请及时使用积分")],-1))])])])]),t("div",mt,[t("div",ht,[s[13]||(s[13]=t("h2",{class:"section-title"},"积分明细",-1)),o(F,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=e=>v.value=e),size:"default",onChange:M,class:"filter-tabs"},{default:n(()=>[o(b,{label:0},{default:n(()=>[...s[10]||(s[10]=[k("全部",-1)])]),_:1}),o(b,{label:1},{default:n(()=>[...s[11]||(s[11]=[k("获得",-1)])]),_:1}),o(b,{label:2},{default:n(()=>[...s[12]||(s[12]=[k("消费",-1)])]),_:1})]),_:1},8,["modelValue"])]),h.value.length>0?(c(),g("div",yt,[(c(!0),g(Q,null,$(h.value,e=>(c(),g("div",{key:e.id,class:"record-item"},[t("div",{class:z(["record-icon",e.points>0?"icon-gain":"icon-cost"])},[e.points>0?(c(),m(i,{key:0},{default:n(()=>[o(u(X))]),_:1})):(c(),m(i,{key:1},{default:n(()=>[o(u(Y))]),_:1}))],2),t("div",bt,[t("div",xt,[t("span",kt,l(N(e.type)),1),t("span",zt,l(e.remark),1)]),t("div",Ct,[t("span",Pt,l(w(e.createTime)),1),t("span",{class:z(["record-expire",E(e.expireDate)])},l(e.expireDate?`有效期至 ${w(e.expireDate)}`:""),3)])]),t("div",wt,[t("div",{class:z(["amount-change",e.points>0?"text-success":"text-danger"])},l(e.points>0?"+":"")+l(e.points),3),t("div",Bt,"余额 "+l(e.pointsAfter),1)])]))),128))])):(c(),m(L,{key:1,description:"暂无积分记录",class:"empty-records"})),y.value>0?(c(),m(U,{key:2,class:"pagination","current-page":d.page,"onUpdate:currentPage":s[1]||(s[1]=e=>d.page=e),"page-size":d.pageSize,"onUpdate:pageSize":s[2]||(s[2]=e=>d.pageSize=e),total:y.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:V,onCurrentChange:T},null,8,["current-page","page-size","total"])):I("",!0)])])}}},Tt=j(St,[["__scopeId","data-v-ed7e5010"]]);export{Tt as default};
