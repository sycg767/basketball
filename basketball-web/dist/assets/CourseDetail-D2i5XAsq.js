import{_ as H,r as h,j as Q,M as W,n as X,d as _,c as v,g as f,e as l,a,f as i,U as Z,E as w,k as ee,o as u,b as e,u as c,$ as se,y as n,i as p,J as B,a0 as te,a1 as le,a3 as ae,F as L,q as E,G as oe,V as ne,O as re,K as ue}from"./index-DfALJeeI.js";import{b as ie,d as de,e as ce}from"./course-DAkwtoVT.js";import"./request-CZtBzr0V.js";const _e={class:"course-detail-container"},ve={class:"course-header"},pe={class:"course-cover"},me={class:"image-slot"},fe={class:"course-basic-info"},ye={class:"course-header-top"},ge={class:"course-name"},he={class:"course-stats"},be={class:"stat-item"},ke={class:"stat-item"},Ce={class:"stat-item"},we={class:"stat-item"},De={class:"course-attributes"},xe={class:"attr-row"},Me={class:"attr-row"},Ve={class:"attr-row"},Se={class:"attr-row"},Ne={class:"attr-row"},Te={class:"course-price"},Be={class:"price-item"},Le={class:"price-value"},Ee={key:0,class:"price-item"},Ue={class:"price-value member"},$e={class:"course-description"},Ie={key:0,class:"course-syllabus"},Pe={key:2,class:"course-video"},Re=["src"],Ye={class:"card-header"},Fe={class:"date-filter"},je={key:0,class:"schedule-list"},qe={class:"schedule-info"},ze={class:"schedule-date"},Ge={class:"schedule-time"},Je={class:"schedule-venue"},Ke={class:"schedule-seats"},Oe={class:"schedule-action"},Ae={class:"price-text"},He={__name:"CourseDetail",setup(Qe){const T=Z(),U=ee(),t=h(null),D=h([]),m=h([]),y=h(!1),b=h(null),x=Q({scheduleId:null}),$=W(()=>t.value?t.value.memberPrice||t.value.price:0),I=async()=>{try{const{data:r}=await ie(T.params.id);t.value=r}catch{w.error("获取课程详情失败")}},M=async()=>{try{const r={};m.value&&m.value.length===2&&(r.startDate=m.value[0],r.endDate=m.value[1]);const{data:s}=await de(T.params.id,r);D.value=s||[]}catch{w.error("获取课程排期失败")}},P=r=>{const s=new Date(r);return`${r} ${["周日","周一","周二","周三","周四","周五","周六"][s.getDay()]}`},R=r=>{b.value=r,x.scheduleId=r.id,y.value=!0},Y=async()=>{try{await ce(x),w.success("报名成功"),y.value=!1,ue.confirm("报名成功，是否前往查看我的课程?","提示",{confirmButtonText:"前往查看",cancelButtonText:"继续浏览",type:"success"}).then(()=>{U.push("/my-courses")}).catch(()=>{M()})}catch(r){w.error(r.message||"报名失败")}},F=r=>({1:"基础班",2:"提高班",3:"专业班",4:"私教课"})[r]||"未知",j=r=>({1:"success",2:"primary",3:"warning",4:"danger"})[r]||"info",q=r=>({1:"入门",2:"初级",3:"中级",4:"高级"})[r]||"未知",z=r=>({1:"success",2:"primary",3:"warning",4:"danger"})[r]||"info";return X(()=>{I(),M()}),(r,s)=>{const d=i("el-icon"),G=i("el-image"),k=i("el-tag"),V=i("el-divider"),S=i("el-card"),J=i("el-date-picker"),N=i("el-button"),K=i("el-empty"),C=i("el-form-item"),O=i("el-form"),A=i("el-dialog");return u(),_("div",_e,[t.value?(u(),v(S,{key:0,class:"course-card"},{default:a(()=>[e("div",ve,[e("div",pe,[l(G,{src:t.value.coverImage||"/images/default-course.jpg",fit:"cover",class:"cover-image"},{error:a(()=>[e("div",me,[l(d,null,{default:a(()=>[l(c(se))]),_:1})])]),_:1},8,["src"])]),e("div",fe,[e("div",ye,[e("h1",ge,n(t.value.courseName),1),l(k,{type:j(t.value.courseType),size:"large"},{default:a(()=>[p(n(F(t.value.courseType)),1)]),_:1},8,["type"])]),e("div",he,[e("div",be,[l(d,null,{default:a(()=>[l(c(B))]),_:1}),e("span",null,"教练："+n(t.value.coachName),1)]),e("div",ke,[l(d,null,{default:a(()=>[l(c(te))]),_:1}),e("span",null,"评分："+n(t.value.rating||"5.0"),1)]),e("div",Ce,[l(d,null,{default:a(()=>[l(c(le))]),_:1}),e("span",null,"浏览："+n(t.value.viewCount||0),1)]),e("div",we,[l(d,null,{default:a(()=>[l(c(ae))]),_:1}),e("span",null,"报名："+n(t.value.enrollCount||0)+"人",1)])]),e("div",De,[e("div",xe,[s[3]||(s[3]=e("span",{class:"attr-label"},"难度等级：",-1)),l(k,{type:z(t.value.difficultyLevel)},{default:a(()=>[p(n(q(t.value.difficultyLevel)),1)]),_:1},8,["type"])]),e("div",Me,[s[4]||(s[4]=e("span",{class:"attr-label"},"适合年龄：",-1)),e("span",null,n(t.value.ageRange),1)]),e("div",Ve,[s[5]||(s[5]=e("span",{class:"attr-label"},"课程人数：",-1)),e("span",null,n(t.value.minStudents)+"-"+n(t.value.maxStudents)+"人",1)]),e("div",Se,[s[6]||(s[6]=e("span",{class:"attr-label"},"课程时长：",-1)),e("span",null,n(t.value.duration)+"分钟/节",1)]),e("div",Ne,[s[7]||(s[7]=e("span",{class:"attr-label"},"总课时：",-1)),e("span",null,n(t.value.totalSessions)+"节课",1)])]),e("div",Te,[e("div",Be,[s[8]||(s[8]=e("span",{class:"price-label"},"普通价格：",-1)),e("span",Le,"¥"+n(t.value.price),1)]),t.value.memberPrice?(u(),_("div",Ee,[s[9]||(s[9]=e("span",{class:"price-label"},"会员价格：",-1)),e("span",Ue,"¥"+n(t.value.memberPrice),1)])):f("",!0)])])]),l(V),e("div",$e,[s[10]||(s[10]=e("h3",null,"课程介绍",-1)),e("p",null,n(t.value.description),1)]),l(V),t.value.syllabusList&&t.value.syllabusList.length>0?(u(),_("div",Ie,[s[11]||(s[11]=e("h3",null,"课程大纲",-1)),e("ul",null,[(u(!0),_(L,null,E(t.value.syllabusList,(o,g)=>(u(),_("li",{key:g},n(o),1))),128))])])):f("",!0),t.value.videoUrl?(u(),v(V,{key:1})):f("",!0),t.value.videoUrl?(u(),_("div",Pe,[s[12]||(s[12]=e("h3",null,"课程视频",-1)),e("video",{src:t.value.videoUrl,controls:"",class:"video-player"},null,8,Re)])):f("",!0)]),_:1})):f("",!0),t.value?(u(),v(S,{key:1,class:"schedule-card"},{header:a(()=>[e("div",Ye,[s[13]||(s[13]=e("span",null,"课程排期",-1)),e("div",Fe,[l(J,{modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=o=>m.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",onChange:M},null,8,["modelValue"])])])]),default:a(()=>[D.value.length>0?(u(),_("div",je,[(u(!0),_(L,null,E(D.value,o=>(u(),v(S,{key:o.id,class:"schedule-item",shadow:"hover"},{default:a(()=>[e("div",qe,[e("div",ze,[l(d,null,{default:a(()=>[l(c(oe))]),_:1}),e("span",null,n(P(o.scheduleDate)),1)]),e("div",Ge,[l(d,null,{default:a(()=>[l(c(ne))]),_:1}),e("span",null,n(o.timeSlot),1)]),e("div",Je,[l(d,null,{default:a(()=>[l(c(re))]),_:1}),e("span",null,n(o.venueName),1)]),e("div",Ke,[l(d,null,{default:a(()=>[l(c(B))]),_:1}),e("span",null,"剩余名额："+n(o.remainingSeats)+"/"+n(o.maxStudents),1)])]),e("div",Oe,[o.status===2?(u(),v(k,{key:0,type:"danger",effect:"dark"},{default:a(()=>[...s[14]||(s[14]=[p(" 已满员 ",-1)])]),_:1})):o.status===5?(u(),v(k,{key:1,type:"info",effect:"dark"},{default:a(()=>[...s[15]||(s[15]=[p(" 已取消 ",-1)])]),_:1})):(u(),v(N,{key:2,type:"primary",disabled:o.status!==1,onClick:g=>R(o)},{default:a(()=>[...s[16]||(s[16]=[p(" 立即报名 ",-1)])]),_:1},8,["disabled","onClick"]))])]),_:2},1024))),128))])):(u(),v(K,{key:1,description:"暂无排期数据"}))]),_:1})):f("",!0),l(A,{modelValue:y.value,"onUpdate:modelValue":s[2]||(s[2]=o=>y.value=o),title:"课程报名",width:"500px"},{footer:a(()=>[l(N,{onClick:s[1]||(s[1]=o=>y.value=!1)},{default:a(()=>[...s[17]||(s[17]=[p("取消",-1)])]),_:1}),l(N,{type:"primary",onClick:Y},{default:a(()=>[...s[18]||(s[18]=[p("确认报名",-1)])]),_:1})]),default:a(()=>[l(O,{model:x,"label-width":"100px"},{default:a(()=>[l(C,{label:"课程名称"},{default:a(()=>{var o;return[e("span",null,n((o=t.value)==null?void 0:o.courseName),1)]}),_:1}),l(C,{label:"上课时间"},{default:a(()=>{var o,g;return[e("span",null,n((o=b.value)==null?void 0:o.scheduleDate)+" "+n((g=b.value)==null?void 0:g.timeSlot),1)]}),_:1}),l(C,{label:"上课地点"},{default:a(()=>{var o;return[e("span",null,n((o=b.value)==null?void 0:o.venueName),1)]}),_:1}),l(C,{label:"课程费用"},{default:a(()=>[e("span",Ae,"¥"+n($.value),1)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},es=H(He,[["__scopeId","data-v-10569911"]]);export{es as default};
