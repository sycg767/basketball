import{_ as de,r as _,k as U,t as se,d as re,b as q,e as l,a,f as s,E as g,a5 as pe,o as D,i,u as k,a6 as me,G as fe,ae as ce,a4 as ge,c as j,v as F,az as ve,aA as ye,g as be,D as _e}from"./index-DqRIPXSt.js";import{d as Ve,e as Ce,s as Te,u as ke,f as xe}from"./admin-BaEEhqJm.js";const Ue={class:"venue-manage-container"},Pe={__name:"VenueManage",setup(we){const P=_(!1),V=_(!1),w=_("新增场地"),x=_(null),C=_(!1),A=_(null),m=U({name:"",type:null}),f=U({page:1,pageSize:10,total:0}),B=_([]),L={1:"室内全场",2:"室内半场",3:"室外全场",4:"室外半场"},O=o=>L[o]||"未知",n=U({id:null,name:"",code:"",type:1,location:"",price:0,capacity:10,facilities:"",status:1}),G={name:[{required:!0,message:"请输入场地名称",trigger:"blur"}],code:[{required:!0,message:"请输入场地编码",trigger:"blur"}],type:[{required:!0,message:"请选择场地类型",trigger:"change"}],location:[{required:!0,message:"请输入场地位置",trigger:"blur"}],capacity:[{required:!0,message:"请输入容纳人数",trigger:"blur"}]},u=U({venueId:null,timeType:1,timePeriod:"08:00-12:00",startTime:"08:00:00",endTime:"12:00:00",price:100}),b=async()=>{P.value=!0;try{const o={page:f.page,pageSize:f.pageSize,venueName:m.name||void 0,venueType:m.type||void 0},e=await Ve(o);B.value=e.data.records.map(d=>({id:d.id,name:d.venueName,code:d.venueCode,type:d.venueType,location:d.location||"-",price:d.basePrice||0,capacity:d.capacity||0,facilities:d.facilities||"",status:d.status})),f.total=e.data.total}catch(o){g.error(o.message||"获取场地列表失败")}finally{P.value=!1}},I=()=>{f.page=1,b()},H=()=>{m.name="",m.type=null,I()},J=()=>{w.value="新增场地",V.value=!0},K=o=>{w.value="编辑场地",Object.assign(n,{id:o.id,name:o.name,code:o.code,type:o.type,location:o.location,price:o.price,capacity:o.capacity,facilities:o.facilities,status:o.status}),V.value=!0},Q=async o=>{try{await _e.confirm(`确定要删除场地"${o.name}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Ce(o.id),g.success("删除成功"),b()}catch(e){e!=="cancel"&&g.error(e.message||"删除失败")}},W=()=>{if(!n.id){g.warning("请先选择场地");return}u.venueId=n.id,C.value=!0},X=o=>{const e={"08:00-12:00":{start:"08:00:00",end:"12:00:00"},"12:00-18:00":{start:"12:00:00",end:"18:00:00"},"18:00-22:00":{start:"18:00:00",end:"22:00:00"}};e[o]&&(u.startTime=e[o].start,u.endTime=e[o].end)},Y=async()=>{try{const o={venueId:u.venueId,timeType:u.timeType,timePeriod:u.timePeriod,startTime:u.startTime,endTime:u.endTime,price:u.price};await Te(o),g.success("价格配置成功"),C.value=!1,b()}catch(o){g.error(o.message||"价格配置失败")}},Z=()=>{Object.assign(u,{venueId:null,timeType:1,timePeriod:"08:00-12:00",startTime:"08:00:00",endTime:"12:00:00",price:100})},h=async()=>{if(x.value)try{await x.value.validate();const o={venueName:n.name,venueCode:n.code,venueType:n.type,location:n.location,capacity:n.capacity,facilities:n.facilities,status:n.status,area:100};n.id?(await ke(n.id,o),g.success("修改成功")):(await xe(o),g.success("新增成功")),V.value=!1,b()}catch(o){o.message&&g.error(o.message||"操作失败")}},ee=()=>{var o;(o=x.value)==null||o.resetFields(),Object.assign(n,{id:null,name:"",code:"",type:1,location:"",price:0,capacity:10,facilities:"",status:1})},le=()=>{b()},ae=()=>{b()};return se(()=>{b()}),(o,e)=>{const d=s("el-input"),r=s("el-form-item"),v=s("el-option"),M=s("el-select"),T=s("el-icon"),p=s("el-button"),z=s("el-form"),N=s("el-card"),y=s("el-table-column"),E=s("el-tag"),te=s("el-table"),oe=s("el-pagination"),c=s("el-radio"),S=s("el-radio-group"),R=s("el-input-number"),ne=s("el-alert"),$=s("el-dialog"),ie=pe("loading");return D(),re("div",Ue,[e[39]||(e[39]=q("h2",{class:"page-title"},"场地管理",-1)),l(N,{class:"search-card"},{default:a(()=>[l(z,{inline:!0,model:m},{default:a(()=>[l(r,{label:"场地名称"},{default:a(()=>[l(d,{modelValue:m.name,"onUpdate:modelValue":e[0]||(e[0]=t=>m.name=t),placeholder:"请输入场地名称",clearable:""},null,8,["modelValue"])]),_:1}),l(r,{label:"场地类型"},{default:a(()=>[l(M,{modelValue:m.type,"onUpdate:modelValue":e[1]||(e[1]=t=>m.type=t),placeholder:"请选择场地类型",clearable:"",style:{width:"180px"}},{default:a(()=>[l(v,{label:"全部",value:null}),l(v,{label:"室内全场",value:1}),l(v,{label:"室内半场",value:2}),l(v,{label:"室外全场",value:3}),l(v,{label:"室外半场",value:4})]),_:1},8,["modelValue"])]),_:1}),l(r,null,{default:a(()=>[l(p,{type:"primary",onClick:I},{default:a(()=>[l(T,null,{default:a(()=>[l(k(me))]),_:1}),e[18]||(e[18]=i(" 搜索 ",-1))]),_:1}),l(p,{onClick:H},{default:a(()=>[l(T,null,{default:a(()=>[l(k(fe))]),_:1}),e[19]||(e[19]=i(" 重置 ",-1))]),_:1}),l(p,{type:"success",onClick:J},{default:a(()=>[l(T,null,{default:a(()=>[l(k(ce))]),_:1}),e[20]||(e[20]=i(" 新增场地 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(N,{class:"table-card"},{default:a(()=>[ge((D(),j(te,{data:B.value,stripe:""},{default:a(()=>[l(y,{prop:"id",label:"ID",width:"70"}),l(y,{prop:"name",label:"场地名称","min-width":"180"}),l(y,{prop:"type",label:"类型",width:"110"},{default:a(({row:t})=>[l(E,{type:t.type<=2?"success":"warning"},{default:a(()=>[i(F(O(t.type)),1)]),_:2},1032,["type"])]),_:1}),l(y,{prop:"location",label:"位置","min-width":"150"}),l(y,{prop:"price",label:"价格/小时",width:"110"},{default:a(({row:t})=>[i(" ¥"+F(t.price),1)]),_:1}),l(y,{prop:"capacity",label:"容纳人数",width:"100"}),l(y,{prop:"status",label:"状态",width:"90"},{default:a(({row:t})=>[l(E,{type:t.status===1?"success":"danger"},{default:a(()=>[i(F(t.status===1?"启用":"停用"),1)]),_:2},1032,["type"])]),_:1}),l(y,{label:"操作",width:"160",fixed:"right"},{default:a(({row:t})=>[l(p,{type:"primary",link:"",onClick:ue=>K(t)},{default:a(()=>[l(T,null,{default:a(()=>[l(k(ve))]),_:1}),e[21]||(e[21]=i(" 编辑 ",-1))]),_:1},8,["onClick"]),l(p,{type:"danger",link:"",onClick:ue=>Q(t)},{default:a(()=>[l(T,null,{default:a(()=>[l(k(ye))]),_:1}),e[22]||(e[22]=i(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ie,P.value]]),l(oe,{"current-page":f.page,"onUpdate:currentPage":e[2]||(e[2]=t=>f.page=t),"page-size":f.pageSize,"onUpdate:pageSize":e[3]||(e[3]=t=>f.pageSize=t),total:f.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:le,onCurrentChange:ae,class:"pagination"},null,8,["current-page","page-size","total"])]),_:1}),l($,{modelValue:C.value,"onUpdate:modelValue":e[8]||(e[8]=t=>C.value=t),title:"配置场地价格",width:"700px",onClose:Z},{footer:a(()=>[l(p,{onClick:e[7]||(e[7]=t=>C.value=!1)},{default:a(()=>[...e[27]||(e[27]=[i("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:Y},{default:a(()=>[...e[28]||(e[28]=[i("确定",-1)])]),_:1})]),default:a(()=>[l(z,{ref_key:"priceFormRef",ref:A,model:u,"label-width":"120px"},{default:a(()=>[l(r,{label:"场地名称"},{default:a(()=>[l(d,{value:n.name,disabled:""},null,8,["value"])]),_:1}),l(r,{label:"时间类型",prop:"timeType"},{default:a(()=>[l(S,{modelValue:u.timeType,"onUpdate:modelValue":e[4]||(e[4]=t=>u.timeType=t)},{default:a(()=>[l(c,{value:1},{default:a(()=>[...e[23]||(e[23]=[i("工作日",-1)])]),_:1}),l(c,{value:2},{default:a(()=>[...e[24]||(e[24]=[i("周末",-1)])]),_:1}),l(c,{value:3},{default:a(()=>[...e[25]||(e[25]=[i("节假日",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"时段",prop:"timePeriod"},{default:a(()=>[l(M,{modelValue:u.timePeriod,"onUpdate:modelValue":e[5]||(e[5]=t=>u.timePeriod=t),placeholder:"请选择时段",onChange:X},{default:a(()=>[l(v,{label:"早场 (08:00-12:00)",value:"08:00-12:00"}),l(v,{label:"午场 (12:00-18:00)",value:"12:00-18:00"}),l(v,{label:"晚场 (18:00-22:00)",value:"18:00-22:00"})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"标准价格(元/小时)",prop:"price"},{default:a(()=>[l(R,{modelValue:u.price,"onUpdate:modelValue":e[6]||(e[6]=t=>u.price=t),min:0,precision:2,step:10},null,8,["modelValue"])]),_:1}),l(ne,{title:"会员折扣说明",type:"info",closable:!1,style:{"margin-top":"10px"}},{default:a(()=>[...e[26]||(e[26]=[i(" 会员价格根据会员等级自动计算：1级9.5折，2级9折，3级8.5折，4级8折，5级7.5折 ",-1)])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l($,{modelValue:V.value,"onUpdate:modelValue":e[17]||(e[17]=t=>V.value=t),title:w.value,width:"600px",onClose:ee},{footer:a(()=>[l(p,{onClick:e[16]||(e[16]=t=>V.value=!1)},{default:a(()=>[...e[37]||(e[37]=[i("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:h},{default:a(()=>[...e[38]||(e[38]=[i("确定",-1)])]),_:1})]),default:a(()=>[l(z,{ref_key:"venueFormRef",ref:x,model:n,rules:G,"label-width":"100px"},{default:a(()=>[l(r,{label:"场地名称",prop:"name"},{default:a(()=>[l(d,{modelValue:n.name,"onUpdate:modelValue":e[9]||(e[9]=t=>n.name=t),placeholder:"请输入场地名称"},null,8,["modelValue"])]),_:1}),l(r,{label:"场地编码",prop:"code"},{default:a(()=>[l(d,{modelValue:n.code,"onUpdate:modelValue":e[10]||(e[10]=t=>n.code=t),placeholder:"请输入场地编码",disabled:!!n.id},null,8,["modelValue","disabled"])]),_:1}),l(r,{label:"场地类型",prop:"type"},{default:a(()=>[l(S,{modelValue:n.type,"onUpdate:modelValue":e[11]||(e[11]=t=>n.type=t)},{default:a(()=>[l(c,{value:1},{default:a(()=>[...e[29]||(e[29]=[i("室内全场",-1)])]),_:1}),l(c,{value:2},{default:a(()=>[...e[30]||(e[30]=[i("室内半场",-1)])]),_:1}),l(c,{value:3},{default:a(()=>[...e[31]||(e[31]=[i("室外全场",-1)])]),_:1}),l(c,{value:4},{default:a(()=>[...e[32]||(e[32]=[i("室外半场",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"位置",prop:"location"},{default:a(()=>[l(d,{modelValue:n.location,"onUpdate:modelValue":e[12]||(e[12]=t=>n.location=t),placeholder:"请输入场地位置"},null,8,["modelValue"])]),_:1}),n.id?(D(),j(r,{key:0,label:"基础价格"},{default:a(()=>[l(d,{value:`¥${n.price||0}/小时`,disabled:""},{append:a(()=>[l(p,{onClick:W},{default:a(()=>[...e[33]||(e[33]=[i("修改价格",-1)])]),_:1})]),_:1},8,["value"]),e[34]||(e[34]=q("div",{style:{color:"#909399","font-size":"12px","margin-top":"4px"}},' 注: 价格需单独配置，请点击"修改价格"按钮进行设置 ',-1))]),_:1})):be("",!0),l(r,{label:"容纳人数",prop:"capacity"},{default:a(()=>[l(R,{modelValue:n.capacity,"onUpdate:modelValue":e[13]||(e[13]=t=>n.capacity=t),min:1},null,8,["modelValue"])]),_:1}),l(r,{label:"设施",prop:"facilities"},{default:a(()=>[l(d,{modelValue:n.facilities,"onUpdate:modelValue":e[14]||(e[14]=t=>n.facilities=t),type:"textarea",rows:3,placeholder:"请输入场地设施，多个设施用逗号分隔"},null,8,["modelValue"])]),_:1}),l(r,{label:"状态",prop:"status"},{default:a(()=>[l(S,{modelValue:n.status,"onUpdate:modelValue":e[15]||(e[15]=t=>n.status=t)},{default:a(()=>[l(c,{value:1},{default:a(()=>[...e[35]||(e[35]=[i("启用",-1)])]),_:1}),l(c,{value:0},{default:a(()=>[...e[36]||(e[36]=[i("停用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},De=de(Pe,[["__scopeId","data-v-4956daf0"]]);export{De as default};
