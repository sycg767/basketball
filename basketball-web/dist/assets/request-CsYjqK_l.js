import{aA as u,E as c}from"./index-Oskx-env.js";const o=u.create({baseURL:"",timeout:15e3,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>(console.error("请求错误:",t),Promise.reject(t)));o.interceptors.response.use(t=>{const{data:e}=t;return e.code===200?e:(c.error(e.message||"请求失败"),Promise.reject(new Error(e.message||"请求失败")))},t=>{console.error("响应错误:",t);let e="网络错误";if(t.response){const{status:r,data:s}=t.response;switch(r){case 400:e=s.message||"请求参数错误";break;case 401:e="登录已过期，请重新登录",localStorage.removeItem("token"),window.location.href="/admin/login";break;case 403:e="没有权限访问";break;case 404:e="请求的资源不存在";break;case 500:e="服务器内部错误";break;default:e=s.message||`请求失败 (${r})`}}else t.request&&(e="网络连接失败");return c.error(e),Promise.reject(t)});const l=(t,e={},r={})=>o({method:"get",url:t,params:e,...r}),i=(t,e={},r={})=>o({method:"post",url:t,data:e,...r}),m=(t,e={},r={})=>o({method:"put",url:t,data:e,...r}),p=(t,e={},r={})=>o({method:"patch",url:t,data:e,...r}),h=(t,e={})=>o({method:"delete",url:t,...e}),f=(t,e,r=null,s={})=>{const a=new FormData;return a.append("file",e),o({method:"post",url:t,data:a,headers:{"Content-Type":"multipart/form-data"},onUploadProgress:r?n=>{const d=Math.round(n.loaded*100/n.total);r(d)}:void 0,...s})},k={get:l,post:i,put:m,patch:p,delete:h,upload:f};export{k as r};
