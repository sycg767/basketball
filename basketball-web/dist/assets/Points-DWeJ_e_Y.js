import{_ as I,r as g,j as L,n as G,d as H,e as t,a as n,f as l,E as v,o as b,b as o,u as w,a6 as J,y as c,i as u,T as K,c as P,v as M}from"./index-DfALJeeI.js";import{c as O,d as Q}from"./member-Bfoywqyw.js";import"./request-CZtBzr0V.js";const W={class:"points-container"},X={class:"points-header"},Y={class:"points-info"},Z={class:"points-icon"},$={class:"points-detail"},ee={class:"points-value"},te={class:"points-tips"},ae={class:"card-header"},se={class:"points-balance"},ne={__name:"Points",setup(oe){const h=g(0),_=g(0),x=g([]),m=g(0),i=L({page:1,pageSize:10}),z=async()=>{try{const a=await O();a.code===200&&(h.value=a.data)}catch{v.error("获取积分失败")}},d=async()=>{try{const a=await Q(i);if(a.code===200){let e=a.data.records;_.value===1?e=e.filter(r=>r.points>0):_.value===2&&(e=e.filter(r=>r.points<0)),x.value=e,m.value=e.length}}catch{v.error("获取积分记录失败")}},T=()=>{z(),d(),v.success("刷新成功")},k=()=>{i.page=1,d()},S=()=>{i.page=1,d()},D=()=>{d()},V=a=>({1:"success",2:"warning",3:"danger",4:"primary"})[a]||"info",B=a=>({1:"消费赠送",2:"积分兑换",3:"积分过期",4:"手动调整"})[a]||"未知",E=a=>{if(!a)return"";const e=new Date,r=new Date(a),f=Math.floor((r-e)/(1e3*60*60*24));return f<0?"text-expired":f<30?"text-warning":""},N=a=>a||"-";return G(()=>{z(),d()}),(a,e)=>{const r=l("el-icon"),f=l("el-button"),R=l("el-alert"),C=l("el-card"),y=l("el-radio-button"),U=l("el-radio-group"),p=l("el-table-column"),j=l("el-tag"),q=l("el-table"),A=l("el-pagination"),F=l("el-empty");return b(),H("div",W,[t(C,{class:"points-card"},{default:n(()=>[o("div",X,[o("div",Y,[o("div",Z,[t(r,null,{default:n(()=>[t(w(J))]),_:1})]),o("div",$,[e[3]||(e[3]=o("div",{class:"points-label"},"我的积分",-1)),o("div",ee,c(h.value),1)])]),t(f,{type:"primary",onClick:T},{default:n(()=>[t(r,null,{default:n(()=>[t(w(K))]),_:1}),e[4]||(e[4]=u(" 刷新 ",-1))]),_:1})]),o("div",te,[t(R,{title:"积分说明",type:"info",closable:!1},{default:n(()=>[...e[5]||(e[5]=[o("ul",null,[o("li",null,"消费满1元即可获得1积分"),o("li",null,"积分可用于兑换礼品或抵扣消费"),o("li",null,"积分有效期为1年,请及时使用")],-1)])]),_:1})])]),_:1}),t(C,{class:"records-card"},{header:n(()=>[o("div",ae,[e[9]||(e[9]=o("span",null,"积分明细",-1)),t(U,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=s=>_.value=s),size:"small",onChange:k},{default:n(()=>[t(y,{label:0},{default:n(()=>[...e[6]||(e[6]=[u("全部",-1)])]),_:1}),t(y,{label:1},{default:n(()=>[...e[7]||(e[7]=[u("获得",-1)])]),_:1}),t(y,{label:2},{default:n(()=>[...e[8]||(e[8]=[u("消费",-1)])]),_:1})]),_:1},8,["modelValue"])])]),default:n(()=>[t(q,{data:x.value,style:{width:"100%"}},{default:n(()=>[t(p,{label:"积分变动",width:"120"},{default:n(({row:s})=>[o("span",{class:M(s.points>0?"text-success":"text-danger")},c(s.points>0?"+":"")+c(s.points),3)]),_:1}),t(p,{label:"类型",width:"120"},{default:n(({row:s})=>[t(j,{type:V(s.type)},{default:n(()=>[u(c(B(s.type)),1)]),_:2},1032,["type"])]),_:1}),t(p,{prop:"remark",label:"说明"}),t(p,{label:"积分余额",width:"120"},{default:n(({row:s})=>[o("span",se,c(s.pointsAfter),1)]),_:1}),t(p,{label:"过期时间",width:"120"},{default:n(({row:s})=>[o("span",{class:M(E(s.expireDate))},c(N(s.expireDate)),3)]),_:1}),t(p,{prop:"createTime",label:"时间",width:"180"})]),_:1},8,["data"]),m.value>0?(b(),P(A,{key:0,class:"pagination","current-page":i.page,"onUpdate:currentPage":e[1]||(e[1]=s=>i.page=s),"page-size":i.pageSize,"onUpdate:pageSize":e[2]||(e[2]=s=>i.pageSize=s),total:m.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:S,onCurrentChange:D},null,8,["current-page","page-size","total"])):(b(),P(F,{key:1,description:"暂无积分记录"}))]),_:1})])}}},pe=I(ne,[["__scopeId","data-v-b88c1c8e"]]);export{pe as default};
