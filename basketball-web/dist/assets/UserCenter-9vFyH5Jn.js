import{_ as K,j as Y,r as y,t as O,E as h,d as x,b as s,e,a as o,f as b,v as r,u as a,g as N,m as Q,o as k,n as W,i as u,G as X,x as Z,H as v,A as B,B as M,C as ss,I as ts,J as es,K as S,L as os,D as as}from"./index-BU1z93KZ.js";import{g as ns,a as is,b as ls}from"./member-Cz1wm3WK.js";import{N as cs,A as ds}from"./AnnouncementSection-D-MudmCd.js";import"./notification-SycZCjrS.js";import"./request-CITddpnx.js";const rs={class:"user-center-container"},us={class:"user-header"},vs={class:"header-content"},_s={class:"logo-section"},fs={class:"user-info"},ps={class:"username"},ms={class:"user-content"},gs={class:"user-info-card"},ys={class:"card-content"},hs={class:"user-avatar"},bs={class:"user-details"},Cs={class:"user-meta"},xs={key:0,class:"member-level"},ks={class:"user-id"},Ds={key:0,class:"member-benefits"},ws={class:"account-panel"},zs={class:"account-item"},Ts={class:"account-value"},Ns={class:"account-item"},Bs={class:"account-value"},Ms={class:"account-item"},Ss={class:"account-value"},Ps={class:"quick-actions"},Us={class:"actions-grid"},Is={class:"action-icon blue"},Ls={class:"action-icon green"},Vs={class:"action-icon orange"},Es={class:"action-icon teal"},As={class:"action-icon purple"},Rs={class:"action-icon gold"},Hs={class:"action-icon red"},$s={class:"action-icon cyan"},Fs={class:"announcement-section"},js={class:"recent-activities"},qs={class:"activity-list"},Gs={class:"activity-item"},Js={class:"activity-icon blue"},Ks={class:"activity-status"},Ys={class:"activity-item"},Os={class:"activity-icon orange"},Qs={class:"activity-status"},Ws={class:"activity-item"},Xs={class:"activity-icon green"},Zs={class:"activity-status"},st={__name:"UserCenter",setup(tt){const d=Q(),c=Y(),D=y(0),w=y(0),_=y(""),C=y([]);O(async()=>{await z()});const z=async()=>{var m;try{const[t,n,g]=await Promise.all([ns(),is(),ls({current:1,size:10})]);if(t.code===200&&(D.value=t.data||0),n.code===200&&(w.value=n.data||0),g.code===200){C.value=((m=g.data)==null?void 0:m.records)||[];const f=C.value.filter(i=>i.status===1||i.status==="1");if(console.log("会员卡数据:",C.value),console.log("有效会员卡:",f),f.length>0){const i=f.reduce((l,p)=>l.expireDate?p.expireDate&&new Date(p.expireDate)>new Date(l.expireDate)?p:l:p);if(i&&i.expireDate){let l;if(typeof i.expireDate=="number"?l=new Date(i.expireDate):l=new Date(i.expireDate),isNaN(l.getTime()))console.error("无效的会员到期时间:",i.expireDate),_.value="未开通";else{const p=new Date;if(p.setHours(0,0,0,0),l.setHours(0,0,0,0),l<p)_.value="已过期";else{const q=l.getFullYear(),G=String(l.getMonth()+1).padStart(2,"0"),J=String(l.getDate()).padStart(2,"0");_.value=`${q}/${G}/${J}`}console.log("会员到期时间:",_.value)}}else _.value="未开通"}else _.value="未开通"}}catch(t){console.error("获取用户数据失败:",t),h.error("获取用户数据失败")}},P=async()=>{h.info("正在刷新数据..."),await z(),h.success("数据已更新")},U=async()=>{try{await as.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),c.logout(),d.push("/login"),h.success("已退出登录")}catch{}},T=()=>(c.realName||c.username||"用户").charAt(0).toUpperCase(),I=()=>({0:"普通用户",1:"银卡会员",2:"金卡会员",3:"铂金会员",4:"VIP会员"})[c.memberLevel]||"普通用户",L=()=>{d.push("/venue")},V=()=>{d.push("/booking")},E=()=>{d.push("/course")},A=()=>{d.push("/my-courses")},R=()=>{d.push("/member/card")},H=()=>{d.push("/member/points")},$=()=>{d.push("/payment/method")},F=()=>{d.push("/notification/list")},j=()=>{d.push("/profile")};return(m,t)=>{const n=b("el-icon"),g=b("el-avatar"),f=b("el-button"),i=b("el-tag");return k(),x("div",rs,[s("div",us,[s("div",vs,[s("div",_s,[e(n,{size:28,color:"#ffffff"},{default:o(()=>[e(a(W))]),_:1}),t[0]||(t[0]=s("h1",null,"用户中心",-1))]),s("div",fs,[e(cs),e(g,{size:32,style:{"margin-right":"12px"}},{default:o(()=>[u(r(T()),1)]),_:1}),s("span",ps,r(a(c).realName||a(c).username||"用户"),1),e(f,{type:"primary",link:"",onClick:j},{default:o(()=>[...t[1]||(t[1]=[u("个人中心",-1)])]),_:1}),e(f,{type:"info",link:"",onClick:P},{default:o(()=>[e(n,{size:14},{default:o(()=>[e(a(X))]),_:1}),t[2]||(t[2]=u(" 刷新 ",-1))]),_:1}),e(f,{type:"danger",link:"",onClick:U},{default:o(()=>[...t[3]||(t[3]=[u("退出",-1)])]),_:1})])])]),s("div",ms,[s("div",gs,[s("div",ys,[s("div",hs,[e(g,{size:80},{default:o(()=>[u(r(T()),1)]),_:1})]),s("div",bs,[s("h2",null,r(a(c).realName||a(c).username||"用户"),1),s("div",Cs,[a(c).memberLevel>0?(k(),x("span",xs,r(I()),1)):N("",!0),s("span",ks,"ID: "+r(a(c).userId),1)]),a(c).memberLevel>0?(k(),x("div",Ds,[...t[4]||(t[4]=[s("p",null,"✨ 会员专享权益：场地预订折扣、优先选场、积分加倍",-1)])])):N("",!0)])]),s("div",ws,[s("div",zs,[t[5]||(t[5]=s("div",{class:"account-label"},"积分余额",-1)),s("div",Ts,r(D.value),1)]),s("div",Ns,[t[6]||(t[6]=s("div",{class:"account-label"},"账户余额",-1)),s("div",Bs,"¥"+r(w.value.toFixed(2)),1)]),s("div",Ms,[t[7]||(t[7]=s("div",{class:"account-label"},"会员到期",-1)),s("div",Ss,r(_.value||"未开通"),1)])])]),s("div",Ps,[t[16]||(t[16]=s("h3",{class:"section-title"},"快捷功能",-1)),s("div",Us,[s("div",{class:"action-card",onClick:L},[s("div",Is,[e(n,{size:32},{default:o(()=>[e(a(Z))]),_:1})]),t[8]||(t[8]=s("div",{class:"action-content"},[s("h4",null,"场地预订"),s("p",null,"查看和预订篮球场地")],-1)),e(n,{class:"arrow-icon"},{default:o(()=>[e(a(v))]),_:1})]),s("div",{class:"action-card",onClick:V},[s("div",Ls,[e(n,{size:32},{default:o(()=>[e(a(B))]),_:1})]),t[9]||(t[9]=s("div",{class:"action-content"},[s("h4",null,"我的预订"),s("p",null,"查看预订记录和状态")],-1)),e(n,{class:"arrow-icon"},{default:o(()=>[e(a(v))]),_:1})]),s("div",{class:"action-card",onClick:E},[s("div",Vs,[e(n,{size:32},{default:o(()=>[e(a(M))]),_:1})]),t[10]||(t[10]=s("div",{class:"action-content"},[s("h4",null,"课程报名"),s("p",null,"查看和报名篮球课程")],-1)),e(n,{class:"arrow-icon"},{default:o(()=>[e(a(v))]),_:1})]),s("div",{class:"action-card",onClick:A},[s("div",Es,[e(n,{size:32},{default:o(()=>[e(a(ss))]),_:1})]),t[11]||(t[11]=s("div",{class:"action-content"},[s("h4",null,"我的课程"),s("p",null,"查看我的课程报名记录")],-1)),e(n,{class:"arrow-icon"},{default:o(()=>[e(a(v))]),_:1})]),s("div",{class:"action-card",onClick:R},[s("div",As,[e(n,{size:32},{default:o(()=>[e(a(ts))]),_:1})]),t[12]||(t[12]=s("div",{class:"action-content"},[s("h4",null,"会员中心"),s("p",null,"查看会员卡和权益")],-1)),e(n,{class:"arrow-icon"},{default:o(()=>[e(a(v))]),_:1})]),s("div",{class:"action-card",onClick:H},[s("div",Rs,[e(n,{size:32},{default:o(()=>[e(a(es))]),_:1})]),t[13]||(t[13]=s("div",{class:"action-content"},[s("h4",null,"我的积分"),s("p",null,"查看积分余额和明细")],-1)),e(n,{class:"arrow-icon"},{default:o(()=>[e(a(v))]),_:1})]),s("div",{class:"action-card",onClick:$},[s("div",Hs,[e(n,{size:32},{default:o(()=>[e(a(S))]),_:1})]),t[14]||(t[14]=s("div",{class:"action-content"},[s("h4",null,"支付管理"),s("p",null,"管理支付方式和账单")],-1)),e(n,{class:"arrow-icon"},{default:o(()=>[e(a(v))]),_:1})]),s("div",{class:"action-card",onClick:F},[s("div",$s,[e(n,{size:32},{default:o(()=>[e(a(os))]),_:1})]),t[15]||(t[15]=s("div",{class:"action-content"},[s("h4",null,"通知中心"),s("p",null,"查看系统通知和消息")],-1)),e(n,{class:"arrow-icon"},{default:o(()=>[e(a(v))]),_:1})])])]),s("div",Fs,[e(ds)]),s("div",js,[t[23]||(t[23]=s("h3",{class:"section-title"},"最近活动",-1)),s("div",qs,[s("div",Gs,[s("div",Js,[e(n,null,{default:o(()=>[e(a(B))]),_:1})]),t[18]||(t[18]=s("div",{class:"activity-content"},[s("h4",null,"场地预订"),s("p",{class:"activity-time"},"2小时前")],-1)),s("div",Ks,[e(i,{type:"success",size:"small"},{default:o(()=>[...t[17]||(t[17]=[u("已确认",-1)])]),_:1})])]),s("div",Ys,[s("div",Os,[e(n,null,{default:o(()=>[e(a(M))]),_:1})]),t[20]||(t[20]=s("div",{class:"activity-content"},[s("h4",null,"课程报名"),s("p",{class:"activity-time"},"1天前")],-1)),s("div",Qs,[e(i,{type:"primary",size:"small"},{default:o(()=>[...t[19]||(t[19]=[u("进行中",-1)])]),_:1})])]),s("div",Ws,[s("div",Xs,[e(n,null,{default:o(()=>[e(a(S))]),_:1})]),t[22]||(t[22]=s("div",{class:"activity-content"},[s("h4",null,"积分兑换"),s("p",{class:"activity-time"},"3天前")],-1)),s("div",Zs,[e(i,{type:"info",size:"small"},{default:o(()=>[...t[21]||(t[21]=[u("已完成",-1)])]),_:1})])])])])])])}}},lt=K(st,[["__scopeId","data-v-3bec9ab4"]]);export{lt as default};
