import{_ as H,r as k,t as J,v as Z,c as M,a as n,b as s,e as o,g as K,f as v,i as m,d as f,u as i,l as tt,x as st,F as V,y as ot,E as S,m as Q,o as r,z as et,A as nt,B as g,C as z,D,s as F,G as it,j as lt,n as P,H as X,I as G,J as b,K as j,L as q,M as at}from"./index-DU9PCbH8.js";import{g as rt,a as dt}from"./member-D45oi1Qc.js";import{g as ct,m as ut,a as _t,b as ft}from"./notification-Cd3NMvAk.js";import{A as pt}from"./AnnouncementSection-BZuGmO6K.js";import"./request-KjaGbLG7.js";const vt={class:"notification-trigger"},gt={class:"notification-popover"},mt={class:"notification-header"},Ct={class:"notification-list"},Et={key:0,class:"notification-loading"},ht=["onClick"],yt={class:"notification-icon"},St={class:"notification-content"},Rt={class:"notification-title"},kt={class:"notification-body"},Nt={class:"notification-time"},At={key:0,class:"notification-badge"},Mt={class:"notification-footer"},bt={__name:"NotificationCenter",setup(W){const d=Q(),l=k([]),p=k(0),C=k(!1);let E=null;J(()=>{N(),B()}),Z(()=>{u()});const N=async()=>{try{const t=await ct();t.code===200&&(p.value=t.data||0)}catch(t){console.error("获取未读数量失败:",t)}},O=async()=>{C.value=!0;try{const t=await ft({page:1,size:10});t.code===200&&(l.value=t.data.records||[])}catch(t){console.error("获取通知列表失败:",t),S.error("获取通知列表失败")}finally{C.value=!1}},L=()=>{O()},T=async t=>{if(t.isRead===0)try{await _t(t.id),t.isRead=1,p.value=Math.max(0,p.value-1)}catch(e){console.error("标记已读失败:",e)}d.push(`/notification/${t.id}`)},U=async()=>{try{await ut(),l.value.forEach(t=>{t.isRead=1}),p.value=0,S.success("已全部标记为已读")}catch(t){console.error("全部已读失败:",t),S.error("操作失败")}},$=()=>{d.push("/notification/list")},A=t=>({BOOKING_SUCCESS:F,BOOKING_CANCEL:D,COURSE_ENROLL_SUCCESS:F,COURSE_ENROLL_CANCEL:D,PAYMENT_SUCCESS:F,REFUND_SUCCESS:z,MEMBER_CARD_EXPIRE_SOON:D,COURSE_START_REMINDER:z,BOOKING_START_REMINDER:z})[t]||it,w=t=>({BOOKING_SUCCESS:"#67C23A",BOOKING_CANCEL:"#E6A23C",COURSE_ENROLL_SUCCESS:"#67C23A",COURSE_ENROLL_CANCEL:"#E6A23C",PAYMENT_SUCCESS:"#67C23A",REFUND_SUCCESS:"#409EFF",MEMBER_CARD_EXPIRE_SOON:"#E6A23C",COURSE_START_REMINDER:"#409EFF",BOOKING_START_REMINDER:"#409EFF"})[t]||"#909399",x=t=>{if(!t)return"";const e=new Date,_=new Date(t),a=e-_,h=60*1e3,y=60*h,R=24*y;if(a<h)return"刚刚";if(a<y)return`${Math.floor(a/h)}分钟前`;if(a<R)return`${Math.floor(a/y)}小时前`;if(a<7*R)return`${Math.floor(a/R)}天前`;{const I=_.getFullYear(),c=String(_.getMonth()+1).padStart(2,"0"),Y=String(_.getDate()).padStart(2,"0");return`${I}-${c}-${Y}`}},B=()=>{E=setInterval(()=>{N()},3e4)},u=()=>{E&&(clearInterval(E),E=null)};return(t,e)=>{const _=v("el-icon"),a=v("el-badge"),h=v("el-button"),y=v("el-divider"),R=v("el-empty"),I=v("el-popover");return r(),M(I,{placement:"bottom-end",width:380,trigger:"click",onShow:L},{reference:n(()=>[s("div",vt,[o(a,{value:p.value,hidden:p.value===0},{default:n(()=>[o(_,{size:24},{default:n(()=>[o(i(ot))]),_:1})]),_:1},8,["value","hidden"])])]),default:n(()=>[s("div",gt,[s("div",mt,[e[1]||(e[1]=s("h4",null,"通知消息",-1)),l.value.length>0?(r(),M(h,{key:0,type:"text",size:"small",onClick:U},{default:n(()=>[...e[0]||(e[0]=[m(" 全部已读 ",-1)])]),_:1})):K("",!0)]),o(y,{style:{margin:"8px 0"}}),s("div",Ct,[C.value?(r(),f("div",Et,[o(_,{class:"is-loading"},{default:n(()=>[o(i(tt))]),_:1}),e[2]||(e[2]=s("p",null,"加载中...",-1))])):l.value.length===0?(r(),M(R,{key:1,description:"暂无通知","image-size":80})):(r(!0),f(V,{key:2},st(l.value,c=>(r(),f("div",{key:c.id,class:et(["notification-item",{"is-unread":c.isRead===0}]),onClick:Y=>T(c)},[s("div",yt,[o(_,{size:20,color:w(c.type)},{default:n(()=>[(r(),M(nt(A(c.type))))]),_:2},1032,["color"])]),s("div",St,[s("div",Rt,g(c.title),1),s("div",kt,g(c.content),1),s("div",Nt,g(x(c.sendTime)),1)]),c.isRead===0?(r(),f("div",At)):K("",!0)],10,ht))),128))]),o(y,{style:{margin:"8px 0"}}),s("div",Mt,[o(h,{type:"text",onClick:$},{default:n(()=>[...e[3]||(e[3]=[m("查看全部",-1)])]),_:1})])])]),_:1})}}},Ot=H(bt,[["__scopeId","data-v-673595d4"]]),Lt={class:"home-container"},Tt={class:"home-header"},Ut={class:"header-content"},$t={class:"logo-section"},wt={class:"user-info"},xt={class:"username"},Bt={class:"home-content"},It={key:0,class:"hero-section"},zt={class:"hero-content"},Dt={class:"hero-actions"},Ft={class:"features"},Pt={class:"feature-tag"},Gt={class:"feature-tag"},Kt={class:"feature-tag"},Vt={class:"feature-tag"},Yt={class:"hero-image"},Xt={class:"image-placeholder"},jt={key:1,class:"user-welcome-section"},qt={class:"welcome-content"},Ht={class:"welcome-text"},Jt={class:"user-stats"},Qt={class:"stat-item"},Wt={class:"stat-value"},Zt={class:"stat-item"},ts={class:"stat-value"},ss={class:"stat-item"},os={class:"stat-value"},es={key:2,class:"announcement-section"},ns={class:"quick-actions"},is={class:"actions-grid"},ls={class:"action-icon blue"},as={class:"action-icon green"},rs={class:"action-icon orange"},ds={class:"action-icon red"},cs={class:"intro-section"},us={class:"intro-grid"},_s={class:"intro-item"},fs={class:"intro-icon blue"},ps={class:"intro-item"},vs={class:"intro-icon green"},gs={class:"intro-item"},ms={class:"intro-icon orange"},Cs={class:"intro-item"},Es={class:"intro-icon red"},hs={__name:"Index",setup(W){const d=Q(),l=lt(),p=k(0),C=k(0),E=async()=>{if(l.isLogin)try{const u=await rt();u.code===200&&(p.value=u.data||0);const t=await dt();t.code===200&&(C.value=t.data||0)}catch(u){console.error("获取用户统计数据失败:",u)}};J(()=>{E()});const N=()=>(l.realName||l.username||"用户").charAt(0).toUpperCase(),O=()=>{d.push("/login")},L=()=>({1:"银卡会员",2:"金卡会员",3:"钻石会员"})[l.memberLevel]||"普通会员",T=()=>{d.push("/register")},U=()=>{d.push("/profile")},$=()=>{at.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l.logout(),S.success("已退出登录"),d.push("/login")}).catch(()=>{})},A=()=>{d.push("/venue")},w=()=>{if(!l.isLogin){S.warning("请先登录"),d.push("/login");return}d.push("/user-center")},x=()=>{d.push("/course")},B=()=>{if(!l.isLogin){S.warning("请先登录"),d.push("/login");return}d.push("/member/card")};return(u,t)=>{const e=v("el-icon"),_=v("el-avatar"),a=v("el-button");return r(),f("div",Lt,[s("div",Tt,[s("div",Ut,[s("div",$t,[o(e,{size:32,color:"#ffffff"},{default:n(()=>[o(i(P))]),_:1}),t[0]||(t[0]=s("h1",null,"篮球场馆预约",-1))]),s("div",wt,[i(l).isLogin?(r(),f(V,{key:0},[o(Ot),o(_,{size:36,style:{"margin-right":"10px"}},{default:n(()=>[m(g(N()),1)]),_:1}),s("span",xt,g(i(l).realName||i(l).username||"用户"),1),o(a,{type:"primary",link:"",onClick:U},{default:n(()=>[...t[1]||(t[1]=[m("个人中心",-1)])]),_:1}),o(a,{type:"danger",link:"",onClick:$},{default:n(()=>[...t[2]||(t[2]=[m("退出",-1)])]),_:1})],64)):(r(),f(V,{key:1},[o(a,{type:"primary",plain:"",onClick:O},{default:n(()=>[...t[3]||(t[3]=[m("登录",-1)])]),_:1}),o(a,{type:"primary",onClick:T},{default:n(()=>[...t[4]||(t[4]=[m("注册",-1)])]),_:1})],64))])])]),s("div",Bt,[i(l).isLogin?(r(),f("div",jt,[s("div",qt,[s("div",Ht,[s("h2",null,"欢迎回来，"+g(i(l).realName||i(l).username||"用户")+"！",1),t[13]||(t[13]=s("p",null,"今天是美好的一天，开始您的运动之旅吧！",-1))]),s("div",Jt,[s("div",Qt,[s("div",Wt,g(L()),1),t[14]||(t[14]=s("div",{class:"stat-label"},"会员等级",-1))]),s("div",Zt,[s("div",ts,g(p.value),1),t[15]||(t[15]=s("div",{class:"stat-label"},"积分余额",-1))]),s("div",ss,[s("div",os,"¥"+g(C.value.toFixed(2)),1),t[16]||(t[16]=s("div",{class:"stat-label"},"账户余额",-1))])])])])):(r(),f("div",It,[s("div",zt,[t[11]||(t[11]=s("h2",{class:"hero-title"},"欢迎来到篮球场馆预约系统",-1)),t[12]||(t[12]=s("p",{class:"hero-subtitle"},"在这里轻松预订心仪的篮球场地，享受专业的运动体验",-1)),s("div",Dt,[o(a,{type:"primary",size:"large",onClick:A},{default:n(()=>[o(e,null,{default:n(()=>[o(i(X))]),_:1}),t[5]||(t[5]=s("span",null,"浏览场地",-1))]),_:1}),o(a,{type:"success",size:"large",plain:"",onClick:u.goToLogin},{default:n(()=>[o(e,null,{default:n(()=>[o(i(G))]),_:1}),t[6]||(t[6]=s("span",null,"立即登录",-1))]),_:1},8,["onClick"])]),s("div",Ft,[s("div",Pt,[o(e,{color:"#409eff"},{default:n(()=>[o(i(b))]),_:1}),t[7]||(t[7]=s("span",null,"在线预订",-1))]),s("div",Gt,[o(e,{color:"#67c23a"},{default:n(()=>[o(i(b))]),_:1}),t[8]||(t[8]=s("span",null,"专业场地",-1))]),s("div",Kt,[o(e,{color:"#e6a23c"},{default:n(()=>[o(i(b))]),_:1}),t[9]||(t[9]=s("span",null,"优惠会员",-1))]),s("div",Vt,[o(e,{color:"#f56c6c"},{default:n(()=>[o(i(b))]),_:1}),t[10]||(t[10]=s("span",null,"便捷支付",-1))])])]),s("div",Yt,[s("div",Xt,[o(e,{size:120,color:"#409eff"},{default:n(()=>[o(i(P))]),_:1})])])])),i(l).isLogin?(r(),f("div",es,[o(pt)])):K("",!0),s("div",ns,[t[25]||(t[25]=s("h3",{class:"section-title"},"快捷功能",-1)),s("div",is,[s("div",{class:"action-card",onClick:A},[s("div",ls,[o(e,{size:40},{default:n(()=>[o(i(X))]),_:1})]),t[17]||(t[17]=s("h4",null,"浏览场地",-1)),t[18]||(t[18]=s("p",null,"查看所有可用的篮球场地",-1))]),s("div",{class:"action-card",onClick:w},[s("div",as,[o(e,{size:40},{default:n(()=>[o(i(j))]),_:1})]),t[19]||(t[19]=s("h4",null,"我的预订",-1)),t[20]||(t[20]=s("p",null,"查看和管理您的场地预订",-1))]),s("div",{class:"action-card",onClick:x},[s("div",rs,[o(e,{size:40},{default:n(()=>[o(i(q))]),_:1})]),t[21]||(t[21]=s("h4",null,"课程报名",-1)),t[22]||(t[22]=s("p",null,"参加专业的篮球培训课程",-1))]),s("div",{class:"action-card",onClick:B},[s("div",ds,[o(e,{size:40},{default:n(()=>[o(i(G))]),_:1})]),t[23]||(t[23]=s("h4",null,"会员中心",-1)),t[24]||(t[24]=s("p",null,"查看会员权益和积分",-1))])])]),s("div",cs,[t[34]||(t[34]=s("h3",{class:"section-title"},"系统功能介绍",-1)),s("div",us,[s("div",_s,[s("div",fs,[o(e,{size:32},{default:n(()=>[o(i(P))]),_:1})]),t[26]||(t[26]=s("h4",null,"场地预订",-1)),t[27]||(t[27]=s("p",null,"支持多种场地类型，实时查看场地状态，方便快捷的预订流程",-1))]),s("div",ps,[s("div",vs,[o(e,{size:32},{default:n(()=>[o(i(j))]),_:1})]),t[28]||(t[28]=s("h4",null,"灵活时段",-1)),t[29]||(t[29]=s("p",null,"灵活的预订时段选择，支持在线支付，预订记录随时查询",-1))]),s("div",gs,[s("div",ms,[o(e,{size:32},{default:n(()=>[o(i(q))]),_:1})]),t[30]||(t[30]=s("h4",null,"课程培训",-1)),t[31]||(t[31]=s("p",null,"专业教练团队，多样化课程选择，线上报名便捷高效",-1))]),s("div",Cs,[s("div",Es,[o(e,{size:32},{default:n(()=>[o(i(G))]),_:1})]),t[32]||(t[32]=s("h4",null,"会员体系",-1)),t[33]||(t[33]=s("p",null,"会员等级制度，积分奖励机制，专属优惠折扣",-1))])])])])])}}},As=H(hs,[["__scopeId","data-v-82920a80"]]);export{As as default};
