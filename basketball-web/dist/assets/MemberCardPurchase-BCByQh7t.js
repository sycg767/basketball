import{_ as O,r as m,j as Q,n as W,d as c,e as t,b as a,f as n,c as y,a as o,E as g,k as X,o as r,F as L,q as N,v as Y,y as d,i,g as b,u as Z,H as ee,K as te}from"./index-Do8XCnNk.js";import{b as se,p as ae}from"./member-BGJcgoV3.js";import"./request-fDvtbK_n.js";const le={class:"card-purchase-container"},oe={class:"purchase-content"},ne={class:"card-type-header"},re={class:"card-type-body"},ce={class:"price"},de={class:"value"},ue={key:0,class:"duration"},ie={class:"value"},pe={key:1,class:"times"},_e={class:"value"},me={class:"level"},fe={class:"value"},ve={key:2,class:"benefits"},ye={class:"benefits-list"},ge={__name:"MemberCardPurchase",setup(be){const f=X(),h=m([]),u=m(null),v=m(!1),p=Q({cardTypeId:null,payMethod:1}),F={payMethod:[{required:!0,message:"请选择支付方式",trigger:"change"}]},k=m(null),E=async()=>{try{const l=await se();l.code===200&&(h.value=l.data.records)}catch{g.error("获取会员卡类型失败")}},I=l=>{u.value=l,p.cardTypeId=l.id},P=async()=>{await k.value.validate(),te.confirm(`确认购买【${u.value.cardName}】吗?`,"确认购买",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{v.value=!0;try{(await ae(p)).code===200&&(g.success("购买成功"),f.push("/member/card"))}catch(l){g.error(l.message||"购买失败")}finally{v.value=!1}}).catch(()=>{})},R=()=>{f.back()},T=()=>{f.back()},$=l=>({1:"primary",2:"success",3:"warning"})[l]||"info",q=l=>({1:"时间卡",2:"次卡",3:"储值卡"})[l]||"未知",S=l=>({1:"普通会员",2:"银卡会员",3:"金卡会员",4:"VIP会员"})[l]||"普通会员";return W(()=>{E()}),(l,e)=>{const j=n("el-page-header"),z=n("el-tag"),D=n("el-icon"),C=n("el-card"),H=n("el-col"),K=n("el-row"),M=n("el-input"),_=n("el-form-item"),x=n("el-radio"),U=n("el-radio-group"),w=n("el-button"),A=n("el-form"),G=n("el-empty");return r(),c("div",le,[t(j,{onBack:T,content:"购买会员卡"}),a("div",oe,[t(K,{gutter:20,class:"card-types"},{default:o(()=>[(r(!0),c(L,null,N(h.value,s=>(r(),y(H,{xs:24,sm:12,md:8,lg:6,key:s.id},{default:o(()=>{var B;return[t(C,{class:Y(["card-type",{"card-selected":((B=u.value)==null?void 0:B.id)===s.id}]),onClick:V=>I(s)},{default:o(()=>[a("div",ne,[a("h3",null,d(s.cardName),1),t(z,{type:$(s.cardType)},{default:o(()=>[i(d(q(s.cardType)),1)]),_:2},1032,["type"])]),a("div",re,[a("div",ce,[e[1]||(e[1]=a("span",{class:"label"},"价格:",-1)),a("span",de,"¥"+d(s.price),1)]),s.cardType===1?(r(),c("div",ue,[e[2]||(e[2]=a("span",{class:"label"},"有效期:",-1)),a("span",ie,d(s.duration)+" 天",1)])):b("",!0),s.cardType===2?(r(),c("div",pe,[e[3]||(e[3]=a("span",{class:"label"},"次数:",-1)),a("span",_e,d(s.times)+" 次",1)])):b("",!0),a("div",me,[e[4]||(e[4]=a("span",{class:"label"},"会员等级:",-1)),a("span",fe,d(S(s.memberLevel)),1)]),s.benefitsList&&s.benefitsList.length?(r(),c("div",ve,[e[5]||(e[5]=a("div",{class:"benefits-title"},"权益:",-1)),a("ul",ye,[(r(!0),c(L,null,N(s.benefitsList,(V,J)=>(r(),c("li",{key:J},[t(D,null,{default:o(()=>[t(Z(ee))]),_:1}),i(" "+d(V),1)]))),128))])])):b("",!0)])]),_:2},1032,["class","onClick"])]}),_:2},1024))),128))]),_:1}),u.value?(r(),y(C,{key:0,class:"purchase-form"},{default:o(()=>[e[10]||(e[10]=a("h3",null,"确认购买信息",-1)),t(A,{model:p,rules:F,ref_key:"purchaseFormRef",ref:k,"label-width":"100px"},{default:o(()=>[t(_,{label:"选择卡类型"},{default:o(()=>[t(M,{value:u.value.cardName,disabled:""},null,8,["value"])]),_:1}),t(_,{label:"支付金额"},{default:o(()=>[t(M,{value:`¥${u.value.price}`,disabled:""},null,8,["value"])]),_:1}),t(_,{label:"支付方式",prop:"payMethod"},{default:o(()=>[t(U,{modelValue:p.payMethod,"onUpdate:modelValue":e[0]||(e[0]=s=>p.payMethod=s)},{default:o(()=>[t(x,{label:1},{default:o(()=>[...e[6]||(e[6]=[i("在线支付",-1)])]),_:1}),t(x,{label:2},{default:o(()=>[...e[7]||(e[7]=[i("余额支付",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(_,null,{default:o(()=>[t(w,{type:"primary",onClick:P,loading:v.value},{default:o(()=>[...e[8]||(e[8]=[i(" 立即购买 ",-1)])]),_:1},8,["loading"]),t(w,{onClick:R},{default:o(()=>[...e[9]||(e[9]=[i("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})):(r(),y(G,{key:1,description:"请先选择要购买的会员卡类型"}))])])}}},Me=O(ge,[["__scopeId","data-v-75f67e45"]]);export{Me as default};
