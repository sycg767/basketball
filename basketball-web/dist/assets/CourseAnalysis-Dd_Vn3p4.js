import{_ as A}from"./BarChart-B_gMieq2.js";import{d as B,e as I,f as T}from"./analytics-Cmz_9IhM.js";import{_ as O,r as d,t as R,E,d as z,b as u,e as a,a as t,c as g,g as H,f as n,a3 as h,a4 as M,i as S,B as k,o as _}from"./index-zUzrFZpX.js";import"./index-D5fw03LZ.js";const P={class:"course-analysis-container"},U={class:"card-header"},$={__name:"CourseAnalysis",setup(j){const m=d(7),p=d(!1),v=d([]),D=d([]),f=d({xAxisData:[],series:[]});R(()=>{y(),N()});const y=async()=>{p.value=!0;try{const s=new Date,e=new Date;e.setDate(e.getDate()-m.value);const o=await B({startDate:e.toISOString().split("T")[0],endDate:s.toISOString().split("T")[0],limit:10});o.code===200&&o.data&&o.data.length>0&&(f.value={xAxisData:o.data.map(l=>l.courseName),series:[{name:"热度分数",data:o.data.map(l=>l.popularityScore||l.score||0)}]})}catch(s){console.error("获取课程排行榜失败:",s),E.error("获取课程排行榜失败")}finally{p.value=!1}},N=async()=>{try{const s=new Date,e=new Date;e.setDate(e.getDate()-30);const o={startDate:e.toISOString().split("T")[0],endDate:s.toISOString().split("T")[0],limit:5},[l,r]=await Promise.all([I(o),T(o)]);l.code===200&&(v.value=l.data||[]),r.code===200&&(D.value=r.data||[])}catch(s){console.error("获取热门/冷门课程失败:",s)}};return(s,e)=>{const o=n("el-option"),l=n("el-select"),r=n("el-card"),i=n("el-table-column"),w=n("el-tag"),x=n("el-table"),C=n("el-col"),V=n("el-row"),b=M("loading");return _(),z("div",P,[e[4]||(e[4]=u("h2",{class:"page-title"},"课程热度分析",-1)),a(r,null,{header:t(()=>[u("div",U,[e[1]||(e[1]=u("span",null,"课程热度排行榜",-1)),a(l,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=c=>m.value=c),onChange:y,size:"small",style:{width:"120px"}},{default:t(()=>[a(o,{label:"最近7天",value:7}),a(o,{label:"最近15天",value:15}),a(o,{label:"最近30天",value:30})]),_:1},8,["modelValue"])])]),default:t(()=>[f.value.xAxisData?(_(),g(A,{key:0,data:f.value,height:"400px","y-axis-name":"热度分数",horizontal:!0},null,8,["data"])):H("",!0)]),_:1}),a(V,{gutter:20,class:"course-lists"},{default:t(()=>[a(C,{xs:24,sm:12},{default:t(()=>[a(r,null,{header:t(()=>[...e[2]||(e[2]=[u("span",null,"热门课程",-1)])]),default:t(()=>[h((_(),g(x,{data:v.value,stripe:""},{default:t(()=>[a(i,{prop:"courseName",label:"课程名称"}),a(i,{prop:"popularityScore",label:"热度",width:"100"},{default:t(({row:c})=>[a(w,{type:"success"},{default:t(()=>[S(k(c.popularityScore),1)]),_:2},1024)]),_:1}),a(i,{prop:"enrollCount",label:"报名数",width:"100"})]),_:1},8,["data"])),[[b,p.value]])]),_:1})]),_:1}),a(C,{xs:24,sm:12},{default:t(()=>[a(r,null,{header:t(()=>[...e[3]||(e[3]=[u("span",null,"冷门课程",-1)])]),default:t(()=>[h((_(),g(x,{data:D.value,stripe:""},{default:t(()=>[a(i,{prop:"courseName",label:"课程名称"}),a(i,{prop:"popularityScore",label:"热度",width:"100"},{default:t(({row:c})=>[a(w,{type:"warning"},{default:t(()=>[S(k(c.popularityScore),1)]),_:2},1024)]),_:1}),a(i,{prop:"enrollCount",label:"报名数",width:"100"})]),_:1},8,["data"])),[[b,p.value]])]),_:1})]),_:1})]),_:1})])}}},K=O($,[["__scopeId","data-v-2a4fb9dd"]]);export{K as default};
