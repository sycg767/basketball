import{_ as ue,r as V,j as x,n as de,d as se,b as $,e as l,a,f as r,E as g,R as re,o as F,i,u as P,S as pe,T as me,a4 as fe,Q as ce,c as j,y as B,ap as ge,aq as ve,g as ye,K as be}from"./index-DfALJeeI.js";import{d as Ve,e as _e,s as Te,u as Ce,f as Pe}from"./admin-BTppw37h.js";import"./request-CZtBzr0V.js";const ke={class:"venue-manage-container"},xe={__name:"VenueManage",setup(Ue){const U=V(!1),_=V(!1),z=V("新增场地"),k=V(null),T=V(!1),L=V(null),m=x({name:"",type:null}),f=x({page:1,pageSize:10,total:0}),I=V([]),O={1:"室内全场",2:"室内半场",3:"室外全场",4:"室外半场"},A=o=>O[o]||"未知",n=x({id:null,name:"",code:"",type:1,location:"",price:0,capacity:10,facilities:"",status:1}),K={name:[{required:!0,message:"请输入场地名称",trigger:"blur"}],code:[{required:!0,message:"请输入场地编码",trigger:"blur"}],type:[{required:!0,message:"请选择场地类型",trigger:"change"}],location:[{required:!0,message:"请输入场地位置",trigger:"blur"}],capacity:[{required:!0,message:"请输入容纳人数",trigger:"blur"}]},u=x({venueId:null,timeType:1,timePeriod:"08:00-12:00",startTime:"08:00:00",endTime:"12:00:00",price:100,memberPrice:90}),b=async()=>{U.value=!0;try{const o={page:f.page,pageSize:f.pageSize,venueName:m.name||void 0,venueType:m.type||void 0},e=await Ve(o);I.value=e.data.records.map(d=>({id:d.id,name:d.venueName,code:d.venueCode,type:d.venueType,location:d.location||"-",price:d.basePrice||0,capacity:d.capacity||0,facilities:d.facilities||"",status:d.status})),f.total=e.data.total}catch(o){g.error(o.message||"获取场地列表失败")}finally{U.value=!1}},M=()=>{f.page=1,b()},Q=()=>{m.name="",m.type=null,M()},G=()=>{z.value="新增场地",_.value=!0},H=o=>{z.value="编辑场地",Object.assign(n,{id:o.id,name:o.name,code:o.code,type:o.type,location:o.location,price:o.price,capacity:o.capacity,facilities:o.facilities,status:o.status}),_.value=!0},J=async o=>{try{await be.confirm(`确定要删除场地"${o.name}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await _e(o.id),g.success("删除成功"),b()}catch(e){e!=="cancel"&&g.error(e.message||"删除失败")}},W=()=>{if(!n.id){g.warning("请先选择场地");return}u.venueId=n.id,T.value=!0},X=o=>{const e={"08:00-12:00":{start:"08:00:00",end:"12:00:00"},"12:00-18:00":{start:"12:00:00",end:"18:00:00"},"18:00-22:00":{start:"18:00:00",end:"22:00:00"}};e[o]&&(u.startTime=e[o].start,u.endTime=e[o].end)},Y=async()=>{try{const o={venueId:u.venueId,timeType:u.timeType,timePeriod:u.timePeriod,startTime:u.startTime,endTime:u.endTime,price:u.price,memberPrice:u.memberPrice};await Te(o),g.success("价格配置成功"),T.value=!1,b()}catch(o){g.error(o.message||"价格配置失败")}},Z=()=>{Object.assign(u,{venueId:null,timeType:1,timePeriod:"08:00-12:00",startTime:"08:00:00",endTime:"12:00:00",price:100,memberPrice:90})},h=async()=>{if(k.value)try{await k.value.validate();const o={venueName:n.name,venueCode:n.code,venueType:n.type,location:n.location,capacity:n.capacity,facilities:n.facilities,status:n.status,area:100};n.id?(await Ce(n.id,o),g.success("修改成功")):(await Pe(o),g.success("新增成功")),_.value=!1,b()}catch(o){o.message&&g.error(o.message||"操作失败")}},ee=()=>{var o;(o=k.value)==null||o.resetFields(),Object.assign(n,{id:null,name:"",code:"",type:1,location:"",price:0,capacity:10,facilities:"",status:1})},le=()=>{b()},ae=()=>{b()};return de(()=>{b()}),(o,e)=>{const d=r("el-input"),s=r("el-form-item"),v=r("el-option"),N=r("el-select"),C=r("el-icon"),p=r("el-button"),S=r("el-form"),R=r("el-card"),y=r("el-table-column"),q=r("el-tag"),te=r("el-table"),oe=r("el-pagination"),c=r("el-radio"),w=r("el-radio-group"),D=r("el-input-number"),E=r("el-dialog"),ne=re("loading");return F(),se("div",ke,[e[39]||(e[39]=$("h2",{class:"page-title"},"场地管理",-1)),l(R,{class:"search-card"},{default:a(()=>[l(S,{inline:!0,model:m},{default:a(()=>[l(s,{label:"场地名称"},{default:a(()=>[l(d,{modelValue:m.name,"onUpdate:modelValue":e[0]||(e[0]=t=>m.name=t),placeholder:"请输入场地名称",clearable:""},null,8,["modelValue"])]),_:1}),l(s,{label:"场地类型"},{default:a(()=>[l(N,{modelValue:m.type,"onUpdate:modelValue":e[1]||(e[1]=t=>m.type=t),placeholder:"请选择场地类型",clearable:""},{default:a(()=>[l(v,{label:"全部",value:null}),l(v,{label:"室内全场",value:1}),l(v,{label:"室内半场",value:2}),l(v,{label:"室外全场",value:3}),l(v,{label:"室外半场",value:4})]),_:1},8,["modelValue"])]),_:1}),l(s,null,{default:a(()=>[l(p,{type:"primary",onClick:M},{default:a(()=>[l(C,null,{default:a(()=>[l(P(pe))]),_:1}),e[19]||(e[19]=i(" 搜索 ",-1))]),_:1}),l(p,{onClick:Q},{default:a(()=>[l(C,null,{default:a(()=>[l(P(me))]),_:1}),e[20]||(e[20]=i(" 重置 ",-1))]),_:1}),l(p,{type:"success",onClick:G},{default:a(()=>[l(C,null,{default:a(()=>[l(P(fe))]),_:1}),e[21]||(e[21]=i(" 新增场地 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(R,{class:"table-card"},{default:a(()=>[ce((F(),j(te,{data:I.value,stripe:""},{default:a(()=>[l(y,{prop:"id",label:"ID",width:"80"}),l(y,{prop:"name",label:"场地名称",width:"150"}),l(y,{prop:"type",label:"类型",width:"120"},{default:a(({row:t})=>[l(q,{type:t.type<=2?"success":"warning"},{default:a(()=>[i(B(A(t.type)),1)]),_:2},1032,["type"])]),_:1}),l(y,{prop:"location",label:"位置"}),l(y,{prop:"price",label:"价格/小时",width:"120"},{default:a(({row:t})=>[i(" ¥"+B(t.price),1)]),_:1}),l(y,{prop:"capacity",label:"容纳人数",width:"100"}),l(y,{prop:"status",label:"状态",width:"100"},{default:a(({row:t})=>[l(q,{type:t.status===1?"success":"danger"},{default:a(()=>[i(B(t.status===1?"启用":"停用"),1)]),_:2},1032,["type"])]),_:1}),l(y,{label:"操作",width:"200",fixed:"right"},{default:a(({row:t})=>[l(p,{type:"primary",link:"",onClick:ie=>H(t)},{default:a(()=>[l(C,null,{default:a(()=>[l(P(ge))]),_:1}),e[22]||(e[22]=i(" 编辑 ",-1))]),_:1},8,["onClick"]),l(p,{type:"danger",link:"",onClick:ie=>J(t)},{default:a(()=>[l(C,null,{default:a(()=>[l(P(ve))]),_:1}),e[23]||(e[23]=i(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ne,U.value]]),l(oe,{"current-page":f.page,"onUpdate:currentPage":e[2]||(e[2]=t=>f.page=t),"page-size":f.pageSize,"onUpdate:pageSize":e[3]||(e[3]=t=>f.pageSize=t),total:f.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:le,onCurrentChange:ae,class:"pagination"},null,8,["current-page","page-size","total"])]),_:1}),l(E,{modelValue:T.value,"onUpdate:modelValue":e[9]||(e[9]=t=>T.value=t),title:"配置场地价格",width:"700px",onClose:Z},{footer:a(()=>[l(p,{onClick:e[8]||(e[8]=t=>T.value=!1)},{default:a(()=>[...e[27]||(e[27]=[i("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:Y},{default:a(()=>[...e[28]||(e[28]=[i("确定",-1)])]),_:1})]),default:a(()=>[l(S,{ref_key:"priceFormRef",ref:L,model:u,"label-width":"120px"},{default:a(()=>[l(s,{label:"场地名称"},{default:a(()=>[l(d,{value:n.name,disabled:""},null,8,["value"])]),_:1}),l(s,{label:"时间类型",prop:"timeType"},{default:a(()=>[l(w,{modelValue:u.timeType,"onUpdate:modelValue":e[4]||(e[4]=t=>u.timeType=t)},{default:a(()=>[l(c,{value:1},{default:a(()=>[...e[24]||(e[24]=[i("工作日",-1)])]),_:1}),l(c,{value:2},{default:a(()=>[...e[25]||(e[25]=[i("周末",-1)])]),_:1}),l(c,{value:3},{default:a(()=>[...e[26]||(e[26]=[i("节假日",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"时段",prop:"timePeriod"},{default:a(()=>[l(N,{modelValue:u.timePeriod,"onUpdate:modelValue":e[5]||(e[5]=t=>u.timePeriod=t),placeholder:"请选择时段",onChange:X},{default:a(()=>[l(v,{label:"早场 (08:00-12:00)",value:"08:00-12:00"}),l(v,{label:"午场 (12:00-18:00)",value:"12:00-18:00"}),l(v,{label:"晚场 (18:00-22:00)",value:"18:00-22:00"})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"标准价格(元/小时)",prop:"price"},{default:a(()=>[l(D,{modelValue:u.price,"onUpdate:modelValue":e[6]||(e[6]=t=>u.price=t),min:0,precision:2,step:10},null,8,["modelValue"])]),_:1}),l(s,{label:"会员价格(元/小时)",prop:"memberPrice"},{default:a(()=>[l(D,{modelValue:u.memberPrice,"onUpdate:modelValue":e[7]||(e[7]=t=>u.memberPrice=t),min:0,precision:2,step:10},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(E,{modelValue:_.value,"onUpdate:modelValue":e[18]||(e[18]=t=>_.value=t),title:z.value,width:"600px",onClose:ee},{footer:a(()=>[l(p,{onClick:e[17]||(e[17]=t=>_.value=!1)},{default:a(()=>[...e[37]||(e[37]=[i("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:h},{default:a(()=>[...e[38]||(e[38]=[i("确定",-1)])]),_:1})]),default:a(()=>[l(S,{ref_key:"venueFormRef",ref:k,model:n,rules:K,"label-width":"100px"},{default:a(()=>[l(s,{label:"场地名称",prop:"name"},{default:a(()=>[l(d,{modelValue:n.name,"onUpdate:modelValue":e[10]||(e[10]=t=>n.name=t),placeholder:"请输入场地名称"},null,8,["modelValue"])]),_:1}),l(s,{label:"场地编码",prop:"code"},{default:a(()=>[l(d,{modelValue:n.code,"onUpdate:modelValue":e[11]||(e[11]=t=>n.code=t),placeholder:"请输入场地编码",disabled:!!n.id},null,8,["modelValue","disabled"])]),_:1}),l(s,{label:"场地类型",prop:"type"},{default:a(()=>[l(w,{modelValue:n.type,"onUpdate:modelValue":e[12]||(e[12]=t=>n.type=t)},{default:a(()=>[l(c,{value:1},{default:a(()=>[...e[29]||(e[29]=[i("室内全场",-1)])]),_:1}),l(c,{value:2},{default:a(()=>[...e[30]||(e[30]=[i("室内半场",-1)])]),_:1}),l(c,{value:3},{default:a(()=>[...e[31]||(e[31]=[i("室外全场",-1)])]),_:1}),l(c,{value:4},{default:a(()=>[...e[32]||(e[32]=[i("室外半场",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"位置",prop:"location"},{default:a(()=>[l(d,{modelValue:n.location,"onUpdate:modelValue":e[13]||(e[13]=t=>n.location=t),placeholder:"请输入场地位置"},null,8,["modelValue"])]),_:1}),n.id?(F(),j(s,{key:0,label:"基础价格"},{default:a(()=>[l(d,{value:`¥${n.price||0}/小时`,disabled:""},{append:a(()=>[l(p,{onClick:W},{default:a(()=>[...e[33]||(e[33]=[i("修改价格",-1)])]),_:1})]),_:1},8,["value"]),e[34]||(e[34]=$("div",{style:{color:"#909399","font-size":"12px","margin-top":"4px"}},' 注: 价格需单独配置，请点击"修改价格"按钮进行设置 ',-1))]),_:1})):ye("",!0),l(s,{label:"容纳人数",prop:"capacity"},{default:a(()=>[l(D,{modelValue:n.capacity,"onUpdate:modelValue":e[14]||(e[14]=t=>n.capacity=t),min:1},null,8,["modelValue"])]),_:1}),l(s,{label:"设施",prop:"facilities"},{default:a(()=>[l(d,{modelValue:n.facilities,"onUpdate:modelValue":e[15]||(e[15]=t=>n.facilities=t),type:"textarea",rows:3,placeholder:"请输入场地设施，多个设施用逗号分隔"},null,8,["modelValue"])]),_:1}),l(s,{label:"状态",prop:"status"},{default:a(()=>[l(w,{modelValue:n.status,"onUpdate:modelValue":e[16]||(e[16]=t=>n.status=t)},{default:a(()=>[l(c,{value:1},{default:a(()=>[...e[35]||(e[35]=[i("启用",-1)])]),_:1}),l(c,{value:0},{default:a(()=>[...e[36]||(e[36]=[i("停用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},De=ue(xe,[["__scopeId","data-v-364277b5"]]);export{De as default};
