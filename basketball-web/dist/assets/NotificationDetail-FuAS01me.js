import{_ as Y,r as g,t as z,a6 as X,E as u,m as H,d as N,a3 as j,a4 as q,c,a as o,f as E,o as i,b as s,g as d,e as n,i as l,u as T,al as J,F as Q,ak as W,A as Z,B as C,T as ee,C as y,D as F,s as O,G as te,M as ae}from"./index-Oskx-env.js";import{c as oe,a as A,d as ne}from"./notification-HJyXG3tP.js";const se={class:"notification-detail-container"},le={class:"back-button"},ie={class:"notification-header"},re={class:"notification-info"},ce={class:"notification-title"},de={class:"notification-meta"},_e={class:"notification-time"},ue={class:"notification-content"},Ee={class:"content-text"},Ce={key:0,class:"related-info"},pe={class:"related-actions"},fe={class:"notification-actions"},Se={__name:"NotificationDetail",setup(Re){const k=X(),p=H(),t=g(null),v=g(!1);z(()=>{I()});const I=async()=>{v.value=!0;try{const a=Number(k.params.id),e=await oe({page:1,size:1});e.code===200&&e.data.records&&e.data.records.length>0?(t.value=e.data.records.find(_=>_.id===a)||e.data.records[0],t.value&&t.value.isRead===0&&(await A(t.value.id),t.value.isRead=1)):(u.error("通知不存在"),p.replace("/notification/list"))}catch(a){console.error("获取通知详情失败:",a),u.error("获取通知详情失败")}finally{v.value=!1}},B=()=>{p.back()},D=async()=>{try{await A(t.value.id),t.value.isRead=1,u.success("已标记为已读")}catch(a){console.error("标记已读失败:",a),u.error("操作失败")}},U=async()=>{try{await ae.confirm("确定要删除这条通知吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ne(t.value.id),u.success("删除成功"),p.replace("/notification/list")}catch(a){a!=="cancel"&&(console.error("删除失败:",a),u.error("删除失败"))}},L=()=>{p.push(`/booking/detail/${t.value.relatedId}`)},h=()=>{p.push(`/course/${t.value.relatedId}`)},b=()=>{u.info("支付详情功能开发中")},w=()=>{p.push("/member/card")},G=a=>({BOOKING_SUCCESS:O,BOOKING_CANCEL:F,COURSE_ENROLL_SUCCESS:O,COURSE_ENROLL_CANCEL:F,PAYMENT_SUCCESS:O,REFUND_SUCCESS:y,MEMBER_CARD_EXPIRE_SOON:F,COURSE_START_REMINDER:y,BOOKING_START_REMINDER:y})[a]||te,K=a=>({BOOKING_SUCCESS:"#67C23A",BOOKING_CANCEL:"#E6A23C",COURSE_ENROLL_SUCCESS:"#67C23A",COURSE_ENROLL_CANCEL:"#E6A23C",PAYMENT_SUCCESS:"#67C23A",REFUND_SUCCESS:"#409EFF",MEMBER_CARD_EXPIRE_SOON:"#E6A23C",COURSE_START_REMINDER:"#409EFF",BOOKING_START_REMINDER:"#409EFF"})[a]||"#909399",x=a=>({BOOKING_SUCCESS:"#F0F9FF",BOOKING_CANCEL:"#FEF6EC",COURSE_ENROLL_SUCCESS:"#F0F9FF",COURSE_ENROLL_CANCEL:"#FEF6EC",PAYMENT_SUCCESS:"#F0F9FF",REFUND_SUCCESS:"#EFF6FF",MEMBER_CARD_EXPIRE_SOON:"#FEF6EC",COURSE_START_REMINDER:"#EFF6FF",BOOKING_START_REMINDER:"#EFF6FF"})[a]||"#F5F7FA",M=a=>({BOOKING:"预订",COURSE:"课程",PAYMENT:"支付",MEMBER_CARD:"会员卡"})[a]||a,P=a=>{if(!a)return"";const e=new Date(a),_=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),S=String(e.getDate()).padStart(2,"0"),f=String(e.getHours()).padStart(2,"0"),R=String(e.getMinutes()).padStart(2,"0"),m=String(e.getSeconds()).padStart(2,"0");return`${_}-${r}-${S} ${f}:${R}:${m}`};return(a,e)=>{const _=E("el-icon"),r=E("el-button"),S=E("el-tag"),f=E("el-divider"),R=E("el-descriptions-item"),m=E("el-descriptions"),V=E("el-card"),$=q("loading");return i(),N("div",se,[j((i(),c(V,null,{default:o(()=>[s("div",le,[n(r,{onClick:B},{default:o(()=>[n(_,null,{default:o(()=>[n(T(J))]),_:1}),e[0]||(e[0]=l(" 返回列表 ",-1))]),_:1})]),t.value?(i(),N(Q,{key:0},[s("div",ie,[s("div",{class:"notification-icon",style:W({backgroundColor:x(t.value.type)})},[n(_,{size:48,color:K(t.value.type)},{default:o(()=>[(i(),c(Z(G(t.value.type))))]),_:1},8,["color"])],4),s("div",re,[s("h2",ce,C(t.value.title),1),s("div",de,[n(S,{type:t.value.isRead===0?"danger":"info",size:"small"},{default:o(()=>[l(C(t.value.isRead===0?"未读":"已读"),1)]),_:1},8,["type"]),s("span",_e,[n(_,null,{default:o(()=>[n(T(ee))]),_:1}),l(" "+C(P(t.value.sendTime)),1)]),t.value.relatedType?(i(),c(S,{key:0,size:"small",type:"info"},{default:o(()=>[l(C(M(t.value.relatedType)),1)]),_:1})):d("",!0)])])]),n(f),s("div",ue,[e[1]||(e[1]=s("h3",null,"消息详情",-1)),s("div",Ee,C(t.value.content),1)]),t.value.relatedType&&t.value.relatedId?(i(),N("div",Ce,[n(f),e[6]||(e[6]=s("h3",null,"相关信息",-1)),n(m,{column:2,border:""},{default:o(()=>[n(R,{label:"关联类型"},{default:o(()=>[l(C(M(t.value.relatedType)),1)]),_:1}),n(R,{label:"关联ID"},{default:o(()=>[l(C(t.value.relatedId),1)]),_:1})]),_:1}),s("div",pe,[t.value.relatedType==="BOOKING"?(i(),c(r,{key:0,type:"primary",onClick:L},{default:o(()=>[...e[2]||(e[2]=[l(" 查看预订详情 ",-1)])]),_:1})):d("",!0),t.value.relatedType==="COURSE"?(i(),c(r,{key:1,type:"primary",onClick:h},{default:o(()=>[...e[3]||(e[3]=[l(" 查看课程详情 ",-1)])]),_:1})):d("",!0),t.value.relatedType==="PAYMENT"?(i(),c(r,{key:2,type:"primary",onClick:b},{default:o(()=>[...e[4]||(e[4]=[l(" 查看支付详情 ",-1)])]),_:1})):d("",!0),t.value.relatedType==="MEMBER_CARD"?(i(),c(r,{key:3,type:"primary",onClick:w},{default:o(()=>[...e[5]||(e[5]=[l(" 查看会员卡 ",-1)])]),_:1})):d("",!0)])])):d("",!0),n(f),s("div",fe,[t.value.isRead===0?(i(),c(r,{key:0,type:"primary",onClick:D},{default:o(()=>[...e[7]||(e[7]=[l(" 标记已读 ",-1)])]),_:1})):d("",!0),n(r,{onClick:U},{default:o(()=>[...e[8]||(e[8]=[l("删除通知",-1)])]),_:1})])],64)):d("",!0)]),_:1})),[[$,v.value]])])}}},Ne=Y(Se,[["__scopeId","data-v-6ae8511f"]]);export{Ne as default};
