import{_ as V,r as M,t as $,a7 as Y,E as _,m as z,d as N,e as n,a4 as X,a5 as H,c,a as o,f as u,o as i,g as d,F as Q,b as s,an as j,P as q,v as E,i as l,u as J,U as W,Q as y,R as F,s as O,S as Z,D as ee}from"./index-DqRIPXSt.js";import{c as te,a as T,d as ae}from"./notification-BeiUfyTe.js";import{B as oe}from"./BackButton-CB8aFD-N.js";const ne={class:"notification-detail-container"},se={class:"notification-header"},ie={class:"notification-info"},le={class:"notification-title"},re={class:"notification-meta"},ce={class:"notification-time"},de={class:"notification-content"},_e={class:"content-text"},ue={key:0,class:"related-info"},Ee={class:"related-actions"},Ce={class:"notification-actions"},pe={__name:"NotificationDetail",setup(Se){const A=Y(),p=z(),t=M(null),m=M(!1);$(()=>{B()});const B=async()=>{m.value=!0;try{const a=Number(A.params.id),e=await te({page:1,size:1});e.code===200&&e.data.records&&e.data.records.length>0?(t.value=e.data.records.find(C=>C.id===a)||e.data.records[0],t.value&&t.value.isRead===0&&(await T(t.value.id),t.value.isRead=1)):(_.error("通知不存在"),p.replace("/notification/list"))}catch(a){console.error("获取通知详情失败:",a),_.error("获取通知详情失败")}finally{m.value=!1}},I=async()=>{try{await T(t.value.id),t.value.isRead=1,_.success("已标记为已读")}catch(a){console.error("标记已读失败:",a),_.error("操作失败")}},U=async()=>{try{await ee.confirm("确定要删除这条通知吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ae(t.value.id),_.success("删除成功"),p.replace("/notification/list")}catch(a){a!=="cancel"&&(console.error("删除失败:",a),_.error("删除失败"))}},D=()=>{p.push(`/booking/detail/${t.value.relatedId}`)},k=()=>{p.push(`/course/${t.value.relatedId}`)},L=()=>{_.info("支付详情功能开发中")},h=()=>{p.push("/member/card")},w=a=>({BOOKING_SUCCESS:O,BOOKING_CANCEL:F,COURSE_ENROLL_SUCCESS:O,COURSE_ENROLL_CANCEL:F,PAYMENT_SUCCESS:O,REFUND_SUCCESS:y,MEMBER_CARD_EXPIRE_SOON:F,COURSE_START_REMINDER:y,BOOKING_START_REMINDER:y})[a]||Z,b=a=>({BOOKING_SUCCESS:"#67C23A",BOOKING_CANCEL:"#E6A23C",COURSE_ENROLL_SUCCESS:"#67C23A",COURSE_ENROLL_CANCEL:"#E6A23C",PAYMENT_SUCCESS:"#67C23A",REFUND_SUCCESS:"#409EFF",MEMBER_CARD_EXPIRE_SOON:"#E6A23C",COURSE_START_REMINDER:"#409EFF",BOOKING_START_REMINDER:"#409EFF"})[a]||"#909399",x=a=>({BOOKING_SUCCESS:"#F0F9FF",BOOKING_CANCEL:"#FEF6EC",COURSE_ENROLL_SUCCESS:"#F0F9FF",COURSE_ENROLL_CANCEL:"#FEF6EC",PAYMENT_SUCCESS:"#F0F9FF",REFUND_SUCCESS:"#EFF6FF",MEMBER_CARD_EXPIRE_SOON:"#FEF6EC",COURSE_START_REMINDER:"#EFF6FF",BOOKING_START_REMINDER:"#EFF6FF"})[a]||"#F5F7FA",g=a=>({BOOKING:"预订",COURSE:"课程",PAYMENT:"支付",MEMBER_CARD:"会员卡"})[a]||a,G=a=>{if(!a)return"";const e=new Date(a),C=e.getFullYear(),f=String(e.getMonth()+1).padStart(2,"0"),S=String(e.getDate()).padStart(2,"0"),R=String(e.getHours()).padStart(2,"0"),v=String(e.getMinutes()).padStart(2,"0"),r=String(e.getSeconds()).padStart(2,"0");return`${C}-${f}-${S} ${R}:${v}:${r}`};return(a,e)=>{const C=u("el-icon"),f=u("el-tag"),S=u("el-divider"),R=u("el-descriptions-item"),v=u("el-descriptions"),r=u("el-button"),K=u("el-card"),P=H("loading");return i(),N("div",ne,[n(oe,{text:"返回列表"}),X((i(),c(K,null,{default:o(()=>[t.value?(i(),N(Q,{key:0},[s("div",se,[s("div",{class:"notification-icon",style:j({backgroundColor:x(t.value.type)})},[n(C,{size:48,color:b(t.value.type)},{default:o(()=>[(i(),c(q(w(t.value.type))))]),_:1},8,["color"])],4),s("div",ie,[s("h2",le,E(t.value.title),1),s("div",re,[n(f,{type:t.value.isRead===0?"danger":"info",size:"small"},{default:o(()=>[l(E(t.value.isRead===0?"未读":"已读"),1)]),_:1},8,["type"]),s("span",ce,[n(C,null,{default:o(()=>[n(J(W))]),_:1}),l(" "+E(G(t.value.sendTime)),1)]),t.value.relatedType?(i(),c(f,{key:0,size:"small",type:"info"},{default:o(()=>[l(E(g(t.value.relatedType)),1)]),_:1})):d("",!0)])])]),n(S),s("div",de,[e[0]||(e[0]=s("h3",null,"消息详情",-1)),s("div",_e,E(t.value.content),1)]),t.value.relatedType&&t.value.relatedId?(i(),N("div",ue,[n(S),e[5]||(e[5]=s("h3",null,"相关信息",-1)),n(v,{column:2,border:""},{default:o(()=>[n(R,{label:"关联类型"},{default:o(()=>[l(E(g(t.value.relatedType)),1)]),_:1}),n(R,{label:"关联ID"},{default:o(()=>[l(E(t.value.relatedId),1)]),_:1})]),_:1}),s("div",Ee,[t.value.relatedType==="BOOKING"?(i(),c(r,{key:0,type:"primary",onClick:D},{default:o(()=>[...e[1]||(e[1]=[l(" 查看预订详情 ",-1)])]),_:1})):d("",!0),t.value.relatedType==="COURSE"?(i(),c(r,{key:1,type:"primary",onClick:k},{default:o(()=>[...e[2]||(e[2]=[l(" 查看课程详情 ",-1)])]),_:1})):d("",!0),t.value.relatedType==="PAYMENT"?(i(),c(r,{key:2,type:"primary",onClick:L},{default:o(()=>[...e[3]||(e[3]=[l(" 查看支付详情 ",-1)])]),_:1})):d("",!0),t.value.relatedType==="MEMBER_CARD"?(i(),c(r,{key:3,type:"primary",onClick:h},{default:o(()=>[...e[4]||(e[4]=[l(" 查看会员卡 ",-1)])]),_:1})):d("",!0)])])):d("",!0),n(S),s("div",Ce,[t.value.isRead===0?(i(),c(r,{key:0,type:"primary",onClick:I},{default:o(()=>[...e[6]||(e[6]=[l(" 标记已读 ",-1)])]),_:1})):d("",!0),n(r,{onClick:U},{default:o(()=>[...e[7]||(e[7]=[l("删除通知",-1)])]),_:1})])],64)):d("",!0)]),_:1})),[[P,m.value]])])}}},ve=V(pe,[["__scopeId","data-v-e293a115"]]);export{ve as default};
