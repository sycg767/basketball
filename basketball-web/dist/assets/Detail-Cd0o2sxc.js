import{_ as Y,r as v,j as h,n as Z,d as A,e as t,Q as ee,a as e,f as c,R as ae,b as d,c as p,g as f,U as le,E as y,k as te,o as i,x as oe,y as s,i as o,A as ne,h as S,s as U,V as E}from"./index-Do8XCnNk.js";import{a as se,p as ue,c as de}from"./booking-JYiOWMfP.js";import"./request-fDvtbK_n.js";const re={class:"booking-detail-container"},ie={class:"detail-content"},ce={class:"status-content"},pe={class:"status-info"},fe={class:"order-no"},_e={class:"price-highlight"},me={class:"action-buttons"},ve={class:"pay-amount"},ye={__name:"Detail",setup(ge){const z=le(),N=te(),M=v(!1),a=v({}),g=v(!1),w=v(!1),b=h({paymentMethod:2}),k=v(!1),D=v(!1),_=h({cancelReason:""}),R=async()=>{M.value=!0;try{const r=await se(z.params.id);a.value=r.data}catch(r){y.error(r.message||"获取预订详情失败"),N.back()}finally{M.value=!1}},I=()=>{N.back()},$=r=>({0:E,1:U,2:S,3:U,4:S,5:ne})[r]||E,j=r=>({0:"#E6A23C",1:"#67C23A",2:"#909399",3:"#67C23A",4:"#909399",5:"#F56C6C"})[r]||"#909399",q=r=>({0:"待支付",1:"已支付",2:"已取消",3:"已完成",4:"已退款",5:"超时取消"})[r]||"未知",L=()=>{b.paymentMethod=2,g.value=!0},Q=async()=>{w.value=!0;try{await ue(a.value.id,{paymentMethod:b.paymentMethod}),y.success("支付成功"),g.value=!1,R()}catch(r){y.error(r.message||"支付失败")}finally{w.value=!1}},G=()=>{_.cancelReason="",k.value=!0},H=async()=>{if(!_.cancelReason.trim()){y.warning("请输入取消原因");return}D.value=!0;try{await de(a.value.id,{cancelReason:_.cancelReason}),y.success("取消成功"),k.value=!1,R()}catch(r){y.error(r.message||"取消失败")}finally{D.value=!1}};return Z(()=>{R()}),(r,l)=>{const J=c("el-page-header"),K=c("el-icon"),x=c("el-card"),u=c("el-descriptions-item"),V=c("el-descriptions"),m=c("el-button"),B=c("el-form-item"),F=c("el-radio"),O=c("el-radio-group"),T=c("el-form"),P=c("el-dialog"),W=c("el-input"),X=ae("loading");return i(),A("div",re,[t(J,{onBack:I,title:"返回"},{content:e(()=>[...l[6]||(l[6]=[d("span",{class:"page-title"},"预订详情",-1)])]),_:1}),ee((i(),A("div",ie,[t(x,{class:"status-card"},{default:e(()=>[d("div",ce,[t(K,{size:48,color:j(a.value.status)},{default:e(()=>[(i(),p(oe($(a.value.status))))]),_:1},8,["color"]),d("div",pe,[d("h2",null,s(q(a.value.status)),1),d("p",fe,"订单号: "+s(a.value.bookingNo),1)])])]),_:1}),t(x,{class:"info-card"},{header:e(()=>[...l[7]||(l[7]=[d("div",{class:"card-header"},[d("span",null,"场地信息")],-1)])]),default:e(()=>[t(V,{column:2,border:""},{default:e(()=>[t(u,{label:"场地名称"},{default:e(()=>[o(s(a.value.venueName),1)]),_:1}),t(u,{label:"场地位置"},{default:e(()=>[o(s(a.value.venueLocation),1)]),_:1})]),_:1})]),_:1}),t(x,{class:"info-card"},{header:e(()=>[...l[8]||(l[8]=[d("div",{class:"card-header"},[d("span",null,"预订信息")],-1)])]),default:e(()=>[t(V,{column:2,border:""},{default:e(()=>[t(u,{label:"预订日期"},{default:e(()=>[o(s(a.value.bookingDate),1)]),_:1}),t(u,{label:"时间段"},{default:e(()=>[o(s(a.value.timeSlot),1)]),_:1}),t(u,{label:"时长"},{default:e(()=>[o(s(a.value.duration)+" 小时 ",1)]),_:1}),t(u,{label:"预订类型"},{default:e(()=>[o(s(a.value.bookingType===1?"按时段":"包场"),1)]),_:1}),a.value.contactName?(i(),p(u,{key:0,label:"联系人"},{default:e(()=>[o(s(a.value.contactName),1)]),_:1})):f("",!0),a.value.contactPhone?(i(),p(u,{key:1,label:"联系电话"},{default:e(()=>[o(s(a.value.contactPhone),1)]),_:1})):f("",!0),a.value.peopleCount?(i(),p(u,{key:2,label:"人数"},{default:e(()=>[o(s(a.value.peopleCount)+" 人 ",1)]),_:1})):f("",!0),a.value.remark?(i(),p(u,{key:3,label:"备注",span:2},{default:e(()=>[o(s(a.value.remark),1)]),_:1})):f("",!0)]),_:1})]),_:1}),t(x,{class:"info-card"},{header:e(()=>[...l[9]||(l[9]=[d("div",{class:"card-header"},[d("span",null,"费用信息")],-1)])]),default:e(()=>[t(V,{column:2,border:""},{default:e(()=>[t(u,{label:"单价"},{default:e(()=>{var n;return[o(" ¥"+s((n=a.value.price)==null?void 0:n.toFixed(2))+"/小时 ",1)]}),_:1}),t(u,{label:"总价"},{default:e(()=>{var n;return[o(" ¥"+s((n=a.value.totalPrice)==null?void 0:n.toFixed(2)),1)]}),_:1}),t(u,{label:"优惠金额"},{default:e(()=>{var n;return[o(" ¥"+s(((n=a.value.discountAmount)==null?void 0:n.toFixed(2))||"0.00"),1)]}),_:1}),t(u,{label:"实付金额"},{default:e(()=>{var n,C;return[d("span",_e,"¥"+s(((n=a.value.actualPrice)==null?void 0:n.toFixed(2))||((C=a.value.totalPrice)==null?void 0:C.toFixed(2))),1)]}),_:1}),a.value.payMethodName?(i(),p(u,{key:0,label:"支付方式"},{default:e(()=>[o(s(a.value.payMethodName),1)]),_:1})):f("",!0)]),_:1})]),_:1}),t(x,{class:"info-card"},{header:e(()=>[...l[10]||(l[10]=[d("div",{class:"card-header"},[d("span",null,"时间信息")],-1)])]),default:e(()=>[t(V,{column:2,border:""},{default:e(()=>[t(u,{label:"创建时间"},{default:e(()=>[o(s(a.value.createTime),1)]),_:1}),a.value.payTime?(i(),p(u,{key:0,label:"支付时间"},{default:e(()=>[o(s(a.value.payTime),1)]),_:1})):f("",!0),a.value.cancelTime?(i(),p(u,{key:1,label:"取消时间"},{default:e(()=>[o(s(a.value.cancelTime),1)]),_:1})):f("",!0),a.value.cancelReason?(i(),p(u,{key:2,label:"取消原因",span:2},{default:e(()=>[o(s(a.value.cancelReason),1)]),_:1})):f("",!0),a.value.expireTime&&a.value.status===0?(i(),p(u,{key:3,label:"过期时间"},{default:e(()=>[o(s(a.value.expireTime),1)]),_:1})):f("",!0)]),_:1})]),_:1}),d("div",me,[a.value.status===0?(i(),p(m,{key:0,type:"success",size:"large",onClick:L},{default:e(()=>[...l[11]||(l[11]=[o(" 立即支付 ",-1)])]),_:1})):f("",!0),a.value.status===0||a.value.status===1?(i(),p(m,{key:1,type:"danger",size:"large",onClick:G},{default:e(()=>[...l[12]||(l[12]=[o(" 取消预订 ",-1)])]),_:1})):f("",!0)])])),[[X,M.value]]),t(P,{modelValue:g.value,"onUpdate:modelValue":l[2]||(l[2]=n=>g.value=n),title:"支付订单",width:"400px"},{footer:e(()=>[t(m,{onClick:l[1]||(l[1]=n=>g.value=!1)},{default:e(()=>[...l[16]||(l[16]=[o("取消",-1)])]),_:1}),t(m,{type:"primary",onClick:Q,loading:w.value},{default:e(()=>[...l[17]||(l[17]=[o("确认支付",-1)])]),_:1},8,["loading"])]),default:e(()=>[t(T,{model:b,"label-width":"100px"},{default:e(()=>[t(B,{label:"订单金额"},{default:e(()=>{var n,C;return[d("div",ve,"¥"+s(((n=a.value.actualPrice)==null?void 0:n.toFixed(2))||((C=a.value.totalPrice)==null?void 0:C.toFixed(2))),1)]}),_:1}),t(B,{label:"支付方式"},{default:e(()=>[t(O,{modelValue:b.paymentMethod,"onUpdate:modelValue":l[0]||(l[0]=n=>b.paymentMethod=n)},{default:e(()=>[t(F,{label:1},{default:e(()=>[...l[13]||(l[13]=[o("在线支付",-1)])]),_:1}),t(F,{label:2},{default:e(()=>[...l[14]||(l[14]=[o("余额支付",-1)])]),_:1}),t(F,{label:3},{default:e(()=>[...l[15]||(l[15]=[o("会员卡",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(P,{modelValue:k.value,"onUpdate:modelValue":l[5]||(l[5]=n=>k.value=n),title:"取消预订",width:"400px"},{footer:e(()=>[t(m,{onClick:l[4]||(l[4]=n=>k.value=!1)},{default:e(()=>[...l[18]||(l[18]=[o("取消",-1)])]),_:1}),t(m,{type:"danger",onClick:H,loading:D.value},{default:e(()=>[...l[19]||(l[19]=[o("确认取消",-1)])]),_:1},8,["loading"])]),default:e(()=>[t(T,{model:_,"label-width":"100px"},{default:e(()=>[t(B,{label:"取消原因",required:""},{default:e(()=>[t(W,{modelValue:_.cancelReason,"onUpdate:modelValue":l[3]||(l[3]=n=>_.cancelReason=n),type:"textarea",rows:4,placeholder:"请输入取消原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Ce=Y(ye,[["__scopeId","data-v-603327e9"]]);export{Ce as default};
