import{_ as O,r as h,k as Q,$ as W,t as X,d as _,e as t,c as v,g as f,a,f as i,a6 as Z,E as w,m as ee,o as u,b as e,u as c,aa as se,B as n,i as p,I as N,P as te,U as le,ab as ae,F as L,x as E,K as oe,T as ne,a1 as re,M as ue}from"./index-zUzrFZpX.js";import{b as ie,d as de,e as ce}from"./course-D7jmh9Oy.js";import{B as _e}from"./BackButton-BCA-o-ra.js";const ve={class:"course-detail-container"},pe={class:"course-header"},me={class:"course-cover"},fe={class:"image-slot"},ye={class:"course-basic-info"},ge={class:"course-header-top"},he={class:"course-name"},be={class:"course-stats"},ke={class:"stat-item"},Ce={class:"stat-item"},we={class:"stat-item"},De={class:"stat-item"},xe={class:"course-attributes"},Me={class:"attr-row"},Be={class:"attr-row"},Ve={class:"attr-row"},Se={class:"attr-row"},Te={class:"attr-row"},Ne={class:"course-price"},Le={class:"price-item"},Ee={class:"price-value"},Ue={key:0,class:"price-item"},Ie={class:"price-value member"},Pe={class:"course-description"},$e={key:0,class:"course-syllabus"},Re={key:2,class:"course-video"},Ye=["src"],Fe={class:"card-header"},je={class:"date-filter"},ze={key:0,class:"schedule-list"},Ke={class:"schedule-info"},qe={class:"schedule-date"},Ae={class:"schedule-time"},Ge={class:"schedule-venue"},He={class:"schedule-seats"},Je={class:"schedule-action"},Oe={class:"price-text"},Qe={__name:"CourseDetail",setup(We){const T=Z(),U=ee(),l=h(null),D=h([]),m=h([]),y=h(!1),b=h(null),x=Q({scheduleId:null}),I=W(()=>l.value?l.value.memberPrice||l.value.price:0),P=async()=>{try{const{data:r}=await ie(T.params.id);l.value=r}catch{w.error("获取课程详情失败")}},M=async()=>{try{const r={};m.value&&m.value.length===2&&(r.startDate=m.value[0],r.endDate=m.value[1]);const{data:s}=await de(T.params.id,r);D.value=s||[]}catch{w.error("获取课程排期失败")}},$=r=>{const s=new Date(r);return`${r} ${["周日","周一","周二","周三","周四","周五","周六"][s.getDay()]}`},R=r=>{b.value=r,x.scheduleId=r.id,y.value=!0},Y=async()=>{try{await ce(x),w.success("报名成功"),y.value=!1,ue.confirm("报名成功，是否前往查看我的课程?","提示",{confirmButtonText:"前往查看",cancelButtonText:"继续浏览",type:"success"}).then(()=>{U.push("/my-courses")}).catch(()=>{M()})}catch(r){w.error(r.message||"报名失败")}},F=r=>({1:"基础班",2:"提高班",3:"专业班",4:"私教课"})[r]||"未知",j=r=>({1:"success",2:"primary",3:"warning",4:"danger"})[r]||"info",z=r=>({1:"入门",2:"初级",3:"中级",4:"高级"})[r]||"未知",K=r=>({1:"success",2:"primary",3:"warning",4:"danger"})[r]||"info";return X(()=>{P(),M()}),(r,s)=>{const d=i("el-icon"),q=i("el-image"),k=i("el-tag"),B=i("el-divider"),V=i("el-card"),A=i("el-date-picker"),S=i("el-button"),G=i("el-empty"),C=i("el-form-item"),H=i("el-form"),J=i("el-dialog");return u(),_("div",ve,[t(_e,{text:"返回列表"}),l.value?(u(),v(V,{key:0,class:"course-card"},{default:a(()=>[e("div",pe,[e("div",me,[t(q,{src:l.value.coverImage||"/images/default-course.jpg",fit:"cover",class:"cover-image"},{error:a(()=>[e("div",fe,[t(d,null,{default:a(()=>[t(c(se))]),_:1})])]),_:1},8,["src"])]),e("div",ye,[e("div",ge,[e("h1",he,n(l.value.courseName),1),t(k,{type:j(l.value.courseType),size:"large"},{default:a(()=>[p(n(F(l.value.courseType)),1)]),_:1},8,["type"])]),e("div",be,[e("div",ke,[t(d,null,{default:a(()=>[t(c(N))]),_:1}),e("span",null,"教练："+n(l.value.coachName),1)]),e("div",Ce,[t(d,null,{default:a(()=>[t(c(te))]),_:1}),e("span",null,"评分："+n(l.value.rating||"5.0"),1)]),e("div",we,[t(d,null,{default:a(()=>[t(c(le))]),_:1}),e("span",null,"浏览："+n(l.value.viewCount||0),1)]),e("div",De,[t(d,null,{default:a(()=>[t(c(ae))]),_:1}),e("span",null,"报名："+n(l.value.enrollCount||0)+"人",1)])]),e("div",xe,[e("div",Me,[s[3]||(s[3]=e("span",{class:"attr-label"},"难度等级：",-1)),t(k,{type:K(l.value.difficultyLevel)},{default:a(()=>[p(n(z(l.value.difficultyLevel)),1)]),_:1},8,["type"])]),e("div",Be,[s[4]||(s[4]=e("span",{class:"attr-label"},"适合年龄：",-1)),e("span",null,n(l.value.ageRange),1)]),e("div",Ve,[s[5]||(s[5]=e("span",{class:"attr-label"},"课程人数：",-1)),e("span",null,n(l.value.minStudents)+"-"+n(l.value.maxStudents)+"人",1)]),e("div",Se,[s[6]||(s[6]=e("span",{class:"attr-label"},"课程时长：",-1)),e("span",null,n(l.value.duration)+"分钟/节",1)]),e("div",Te,[s[7]||(s[7]=e("span",{class:"attr-label"},"总课时：",-1)),e("span",null,n(l.value.totalSessions)+"节课",1)])]),e("div",Ne,[e("div",Le,[s[8]||(s[8]=e("span",{class:"price-label"},"普通价格：",-1)),e("span",Ee,"¥"+n(l.value.price),1)]),l.value.memberPrice?(u(),_("div",Ue,[s[9]||(s[9]=e("span",{class:"price-label"},"会员价格：",-1)),e("span",Ie,"¥"+n(l.value.memberPrice),1)])):f("",!0)])])]),t(B),e("div",Pe,[s[10]||(s[10]=e("h3",null,"课程介绍",-1)),e("p",null,n(l.value.description),1)]),t(B),l.value.syllabusList&&l.value.syllabusList.length>0?(u(),_("div",$e,[s[11]||(s[11]=e("h3",null,"课程大纲",-1)),e("ul",null,[(u(!0),_(L,null,E(l.value.syllabusList,(o,g)=>(u(),_("li",{key:g},n(o),1))),128))])])):f("",!0),l.value.videoUrl?(u(),v(B,{key:1})):f("",!0),l.value.videoUrl?(u(),_("div",Re,[s[12]||(s[12]=e("h3",null,"课程视频",-1)),e("video",{src:l.value.videoUrl,controls:"",class:"video-player"},null,8,Ye)])):f("",!0)]),_:1})):f("",!0),l.value?(u(),v(V,{key:1,class:"schedule-card"},{header:a(()=>[e("div",Fe,[s[13]||(s[13]=e("span",null,"课程排期",-1)),e("div",je,[t(A,{modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=o=>m.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",onChange:M},null,8,["modelValue"])])])]),default:a(()=>[D.value.length>0?(u(),_("div",ze,[(u(!0),_(L,null,E(D.value,o=>(u(),v(V,{key:o.id,class:"schedule-item",shadow:"hover"},{default:a(()=>[e("div",Ke,[e("div",qe,[t(d,null,{default:a(()=>[t(c(oe))]),_:1}),e("span",null,n($(o.scheduleDate)),1)]),e("div",Ae,[t(d,null,{default:a(()=>[t(c(ne))]),_:1}),e("span",null,n(o.timeSlot),1)]),e("div",Ge,[t(d,null,{default:a(()=>[t(c(re))]),_:1}),e("span",null,n(o.venueName),1)]),e("div",He,[t(d,null,{default:a(()=>[t(c(N))]),_:1}),e("span",null,"剩余名额："+n(o.remainingSeats)+"/"+n(o.maxStudents),1)])]),e("div",Je,[o.status===2?(u(),v(k,{key:0,type:"danger",effect:"dark"},{default:a(()=>[...s[14]||(s[14]=[p(" 已满员 ",-1)])]),_:1})):o.status===5?(u(),v(k,{key:1,type:"info",effect:"dark"},{default:a(()=>[...s[15]||(s[15]=[p(" 已取消 ",-1)])]),_:1})):(u(),v(S,{key:2,type:"primary",disabled:o.status!==1,onClick:g=>R(o)},{default:a(()=>[...s[16]||(s[16]=[p(" 立即报名 ",-1)])]),_:1},8,["disabled","onClick"]))])]),_:2},1024))),128))])):(u(),v(G,{key:1,description:"暂无排期数据"}))]),_:1})):f("",!0),t(J,{modelValue:y.value,"onUpdate:modelValue":s[2]||(s[2]=o=>y.value=o),title:"课程报名",width:"500px"},{footer:a(()=>[t(S,{onClick:s[1]||(s[1]=o=>y.value=!1)},{default:a(()=>[...s[17]||(s[17]=[p("取消",-1)])]),_:1}),t(S,{type:"primary",onClick:Y},{default:a(()=>[...s[18]||(s[18]=[p("确认报名",-1)])]),_:1})]),default:a(()=>[t(H,{model:x,"label-width":"100px"},{default:a(()=>[t(C,{label:"课程名称"},{default:a(()=>{var o;return[e("span",null,n((o=l.value)==null?void 0:o.courseName),1)]}),_:1}),t(C,{label:"上课时间"},{default:a(()=>{var o,g;return[e("span",null,n((o=b.value)==null?void 0:o.scheduleDate)+" "+n((g=b.value)==null?void 0:g.timeSlot),1)]}),_:1}),t(C,{label:"上课地点"},{default:a(()=>{var o;return[e("span",null,n((o=b.value)==null?void 0:o.venueName),1)]}),_:1}),t(C,{label:"课程费用"},{default:a(()=>[e("span",Oe,"¥"+n(I.value),1)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ss=O(Qe,[["__scopeId","data-v-5e80970c"]]);export{ss as default};
